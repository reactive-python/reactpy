<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="It's React, but in Python."><meta name=author content=Archmonger><link href=https://reactive-python.github.io/reactpy/learn/reusing-logic-with-custom-hooks/ rel=canonical><link href=../removing-effect-dependencies/ rel=prev><link href=../communicate-data-between-server-and-client/ rel=next><link rel=icon href=https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.4.0"><title>Reusing Logic with Custom Hooks 🚧 - ReactPy</title><link rel=stylesheet href=../../assets/stylesheets/main.9f615399.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.649f08f9.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64H64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64 32-32z"/></svg>');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../assets/css/main.css><link rel=stylesheet href=../../assets/css/button.css><link rel=stylesheet href=../../assets/css/admonition.css><link rel=stylesheet href=../../assets/css/banner.css><link rel=stylesheet href=../../assets/css/sidebar.css><link rel=stylesheet href=../../assets/css/navbar.css><link rel=stylesheet href=../../assets/css/table-of-contents.css><link rel=stylesheet href=../../assets/css/code.css><link rel=stylesheet href=../../assets/css/footer.css><link rel=stylesheet href=../../assets/css/home.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest release. <a href=../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=ReactPy class="md-header__button md-logo" aria-label=ReactPy data-md-component=logo> <img src=https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ReactPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Reusing Logic with Custom Hooks 🚧 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81 1.42-1.42M1 13h3v-2H1m12 9h-2v3h2"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/reactive-python/reactpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> ReactPy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../quick-start/ class=md-tabs__link> Get Started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../your-first-component/ class=md-tabs__link> Learn </a> </li> <li class=md-tabs__item> <a href=../../reference/overview/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../about/changelog/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=ReactPy class="md-nav__button md-logo" aria-label=ReactPy data-md-component=logo> <img src=https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg alt=logo> </a> ReactPy </label> <div class=md-nav__source> <a href=https://github.com/reactive-python/reactpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> ReactPy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Get Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Get Started </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Quick Start </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Quick Start </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick start </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-tic-tac-toe/ class=md-nav__link> <span class=md-ellipsis> Tutorial: Tic-Tac-Toe 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../thinking-in-react/ class=md-nav__link> <span class=md-ellipsis> Thinking in React </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Installation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../creating-a-react-app/ class=md-nav__link> <span class=md-ellipsis> Creating a Standalone React App </span> </a> </li> <li class=md-nav__item> <a href=../add-react-to-an-existing-project/ class=md-nav__link> <span class=md-ellipsis> Add React to an Existing Project </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../editor-setup/ class=md-nav__link> <span class=md-ellipsis> Editor Setup </span> </a> </li> <li class=md-nav__item> <a href=../extra-tools-and-packages/ class=md-nav__link> <span class=md-ellipsis> Tools, Modules, and Packages 🚧 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Learn </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> Describing the UI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Describing the UI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../your-first-component/ class=md-nav__link> <span class=md-ellipsis> Your First Component 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../importing-and-exporting-components/ class=md-nav__link> <span class=md-ellipsis> Importing and Exporting Components 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../passing-props-to-a-component/ class=md-nav__link> <span class=md-ellipsis> Passing Props to a Component 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../conditional-rendering/ class=md-nav__link> <span class=md-ellipsis> Conditional Rendering 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../rendering-lists/ class=md-nav__link> <span class=md-ellipsis> Rendering Lists 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../keeping-components-pure/ class=md-nav__link> <span class=md-ellipsis> Keeping Components Pure 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Adding Interactivity </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Adding Interactivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../responding-to-events/ class=md-nav__link> <span class=md-ellipsis> Responding to Events 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../state-a-components-memory/ class=md-nav__link> <span class=md-ellipsis> State: A Component's Memory 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../render-and-commit/ class=md-nav__link> <span class=md-ellipsis> Render and Commit 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../state-as-a-snapshot/ class=md-nav__link> <span class=md-ellipsis> State as a Snapshot 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../queueing-a-series-of-state-updates/ class=md-nav__link> <span class=md-ellipsis> Queueing a Series of State Updates 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../updating-objects-in-state/ class=md-nav__link> <span class=md-ellipsis> Updating Objects in State 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../updating-arrays-in-state/ class=md-nav__link> <span class=md-ellipsis> Updating Arrays in State 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Managing State </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Managing State </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../reacting-to-input-with-state/ class=md-nav__link> <span class=md-ellipsis> Reacting to Input with State 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../choosing-the-state-structure/ class=md-nav__link> <span class=md-ellipsis> Choosing the State Structure 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../sharing-state-between-components/ class=md-nav__link> <span class=md-ellipsis> Sharing State Between Components 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../preserving-and-resetting-state/ class=md-nav__link> <span class=md-ellipsis> Preserving and Resetting State 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../extracting-state-logic-into-a-reducer/ class=md-nav__link> <span class=md-ellipsis> Extracting State Logic into a Reducer 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../passing-data-deeply-with-context/ class=md-nav__link> <span class=md-ellipsis> Passing Data Deeply with Context 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../scaling-up-with-reducer-and-context/ class=md-nav__link> <span class=md-ellipsis> Scaling Up with Reducer and Context 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4 checked> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Escape Hatches </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=true> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Escape Hatches </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../referencing-values-with-refs/ class=md-nav__link> <span class=md-ellipsis> Referencing Values with Refs 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../manipulating-the-dom-with-refs/ class=md-nav__link> <span class=md-ellipsis> Manipulating the DOM with Refs 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../synchronizing-with-effects/ class=md-nav__link> <span class=md-ellipsis> Synchronizing with Effects 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../you-might-not-need-an-effect/ class=md-nav__link> <span class=md-ellipsis> You Might Not Need an Effect 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../lifecycle-of-reactive-effects/ class=md-nav__link> <span class=md-ellipsis> Lifecycle of Reactive Effects 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../separating-events-from-effects/ class=md-nav__link> <span class=md-ellipsis> Separating Events from Effects 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../removing-effect-dependencies/ class=md-nav__link> <span class=md-ellipsis> Removing Effect Dependencies 🚧 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Reusing Logic with Custom Hooks 🚧 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Reusing Logic with Custom Hooks 🚧 </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#custom-hooks-sharing-logic-between-components class=md-nav__link> Custom Hooks: Sharing logic between components </a> <nav class=md-nav aria-label="Custom Hooks: Sharing logic between components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#extracting-your-own-custom-hook-from-a-component class=md-nav__link> Extracting your own custom Hook from a component </a> </li> <li class=md-nav__item> <a href=#hook-names-always-start-with-use class=md-nav__link> Hook names always start with use </a> <nav class=md-nav aria-label="Hook names always start with use"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#should-all-functions-called-during-rendering-start-with-the-use-prefix class=md-nav__link> Should all functions called during rendering start with the use prefix? </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#custom-hooks-let-you-share-stateful-logic-not-state-itself class=md-nav__link> Custom Hooks let you share stateful logic, not state itself </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#passing-reactive-values-between-hooks class=md-nav__link> Passing reactive values between Hooks </a> <nav class=md-nav aria-label="Passing reactive values between Hooks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#passing-event-handlers-to-custom-hooks class=md-nav__link> Passing event handlers to custom Hooks </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#when-to-use-custom-hooks class=md-nav__link> When to use custom Hooks </a> <nav class=md-nav aria-label="When to use custom Hooks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#keep-your-custom-hooks-focused-on-concrete-high-level-use-cases class=md-nav__link> Keep your custom Hooks focused on concrete high-level use cases </a> </li> <li class=md-nav__item> <a href=#custom-hooks-help-you-migrate-to-better-patterns class=md-nav__link> Custom Hooks help you migrate to better patterns </a> <nav class=md-nav aria-label="Custom Hooks help you migrate to better patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#will-react-provide-any-built-in-solution-for-data-fetching class=md-nav__link> Will React provide any built-in solution for data fetching? </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#there-is-more-than-one-way-to-do-it class=md-nav__link> There is more than one way to do it </a> <nav class=md-nav aria-label="There is more than one way to do it"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#extract-a-usecounter-hook class=md-nav__link> Extract a useCounter Hook </a> </li> <li class=md-nav__item> <a href=#make-the-counter-delay-configurable class=md-nav__link> Make the counter delay configurable </a> </li> <li class=md-nav__item> <a href=#extract-useinterval-out-of-usecounter class=md-nav__link> Extract useInterval out of useCounter </a> </li> <li class=md-nav__item> <a href=#fix-a-resetting-interval class=md-nav__link> Fix a resetting interval </a> </li> <li class=md-nav__item> <a href=#implement-a-staggering-movement class=md-nav__link> Implement a staggering movement </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../communicate-data-between-server-and-client/ class=md-nav__link> <span class=md-ellipsis> Communicating Data Between Server and Client 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../convert-between-vdom-and-html/ class=md-nav__link> <span class=md-ellipsis> Convert Between VDOM and HTML 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../vdom-mutations/ class=md-nav__link> <span class=md-ellipsis> VDOM Mutations 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../creating-vdom-event-handlers/ class=md-nav__link> <span class=md-ellipsis> Creating VDOM Event Handlers 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../creating-html-tags/ class=md-nav__link> <span class=md-ellipsis> Creating HTML Tags 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../creating-backends/ class=md-nav__link> <span class=md-ellipsis> Creating Backends 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../manually-register-a-client/ class=md-nav__link> <span class=md-ellipsis> Manually Register a Client 🚧 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Hooks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Hooks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/use-state/ class=md-nav__link> <span class=md-ellipsis> Use State 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-effect/ class=md-nav__link> <span class=md-ellipsis> Use Effect 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-async-effect/ class=md-nav__link> <span class=md-ellipsis> Use Async Effect 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-context/ class=md-nav__link> <span class=md-ellipsis> Use Context 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-reducer/ class=md-nav__link> <span class=md-ellipsis> Use Reducer 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-callback/ class=md-nav__link> <span class=md-ellipsis> Use Callback 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-memo/ class=md-nav__link> <span class=md-ellipsis> Use Memo 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-ref/ class=md-nav__link> <span class=md-ellipsis> Use Ref 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-debug-value/ class=md-nav__link> <span class=md-ellipsis> Use Debug Value 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-connection/ class=md-nav__link> <span class=md-ellipsis> Use Connection 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-scope/ class=md-nav__link> <span class=md-ellipsis> Use Scope 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-location/ class=md-nav__link> <span class=md-ellipsis> Use Location 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> HTML Tags </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> HTML Tags </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/common-props/ class=md-nav__link> <span class=md-ellipsis> Common Props 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/usage/ class=md-nav__link> <span class=md-ellipsis> Usage 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Executors </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Executors </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/reactpy/ class=md-nav__link> <span class=md-ellipsis> ReactPy </span> </a> </li> <li class=md-nav__item> <a href=../../reference/reactpy-csr/ class=md-nav__link> <span class=md-ellipsis> ReactPyCsr 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/reactpy-middleware/ class=md-nav__link> <span class=md-ellipsis> ReactPyMiddleware 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> Rules of React </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Rules of React </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/rules-of-react/ class=md-nav__link> <span class=md-ellipsis> Overview 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/components-and-hooks-must-be-pure/ class=md-nav__link> <span class=md-ellipsis> Components and Hooks must be pure 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/react-calls-components-and-hooks/ class=md-nav__link> <span class=md-ellipsis> React calls Components and Hooks 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/rules-of-hooks/ class=md-nav__link> <span class=md-ellipsis> Rules of Hooks 🚧 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../reference/protocol-structure/ class=md-nav__link> <span class=md-ellipsis> Protocol Structure 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../reference/client-api/ class=md-nav__link> <span class=md-ellipsis> Client API 🚧 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../about/community/ class=md-nav__link> <span class=md-ellipsis> Community 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../about/running-tests/ class=md-nav__link> <span class=md-ellipsis> Running Tests 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../about/code/ class=md-nav__link> <span class=md-ellipsis> Contributing Code 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../about/docs/ class=md-nav__link> <span class=md-ellipsis> Contributing Documentation 🚧 </span> </a> </li> <li class=md-nav__item> <a href=../../about/licenses/ class=md-nav__link> <span class=md-ellipsis> Licenses 🚧 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#custom-hooks-sharing-logic-between-components class=md-nav__link> Custom Hooks: Sharing logic between components </a> <nav class=md-nav aria-label="Custom Hooks: Sharing logic between components"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#extracting-your-own-custom-hook-from-a-component class=md-nav__link> Extracting your own custom Hook from a component </a> </li> <li class=md-nav__item> <a href=#hook-names-always-start-with-use class=md-nav__link> Hook names always start with use </a> <nav class=md-nav aria-label="Hook names always start with use"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#should-all-functions-called-during-rendering-start-with-the-use-prefix class=md-nav__link> Should all functions called during rendering start with the use prefix? </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#custom-hooks-let-you-share-stateful-logic-not-state-itself class=md-nav__link> Custom Hooks let you share stateful logic, not state itself </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#passing-reactive-values-between-hooks class=md-nav__link> Passing reactive values between Hooks </a> <nav class=md-nav aria-label="Passing reactive values between Hooks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#passing-event-handlers-to-custom-hooks class=md-nav__link> Passing event handlers to custom Hooks </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#when-to-use-custom-hooks class=md-nav__link> When to use custom Hooks </a> <nav class=md-nav aria-label="When to use custom Hooks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#keep-your-custom-hooks-focused-on-concrete-high-level-use-cases class=md-nav__link> Keep your custom Hooks focused on concrete high-level use cases </a> </li> <li class=md-nav__item> <a href=#custom-hooks-help-you-migrate-to-better-patterns class=md-nav__link> Custom Hooks help you migrate to better patterns </a> <nav class=md-nav aria-label="Custom Hooks help you migrate to better patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#will-react-provide-any-built-in-solution-for-data-fetching class=md-nav__link> Will React provide any built-in solution for data fetching? </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#there-is-more-than-one-way-to-do-it class=md-nav__link> There is more than one way to do it </a> <nav class=md-nav aria-label="There is more than one way to do it"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#extract-a-usecounter-hook class=md-nav__link> Extract a useCounter Hook </a> </li> <li class=md-nav__item> <a href=#make-the-counter-delay-configurable class=md-nav__link> Make the counter delay configurable </a> </li> <li class=md-nav__item> <a href=#extract-useinterval-out-of-usecounter class=md-nav__link> Extract useInterval out of useCounter </a> </li> <li class=md-nav__item> <a href=#fix-a-resetting-interval class=md-nav__link> Fix a resetting interval </a> </li> <li class=md-nav__item> <a href=#implement-a-staggering-movement class=md-nav__link> Implement a staggering movement </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Reusing Logic with Custom Hooks 🚧</h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p class=intro> React comes with several built-in Hooks like <code>useState</code>, <code>useContext</code>, and <code>useEffect</code>. Sometimes, you'll wish that there was a Hook for some more specific purpose: for example, to fetch data, to keep track of whether the user is online, or to connect to a chat room. You might not find these Hooks in React, but you can create your own Hooks for your application's needs. </p> <div class="admonition summary"> <p class=admonition-title>You will learn</p> <ul> <li>What custom Hooks are, and how to write your own</li> <li>How to reuse logic between components</li> <li>How to name and structure your custom Hooks</li> <li>When and why to extract custom Hooks</li> </ul> </div> <h2 id=custom-hooks-sharing-logic-between-components>Custom Hooks: Sharing logic between components<a class=headerlink href=#custom-hooks-sharing-logic-between-components title="Permanent link">&para;</a></h2> <p>Imagine you're developing an app that heavily relies on the network (as most apps do). You want to warn the user if their network connection has accidentally gone off while they were using your app. How would you go about it? It seems like you'll need two things in your component:</p> <ol> <li>A piece of state that tracks whether the network is online.</li> <li>An Effect that subscribes to the global <a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/online_event><code>online</code></a> and <a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/offline_event><code>offline</code></a> events, and updates that state.</li> </ol> <p>This will keep your component <a href=/learn/synchronizing-with-effects>synchronized</a> with the network status. You might start with something like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;✅ Online&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;❌ Disconnected&quot;</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Try turning your network on and off, and notice how this <code>StatusBar</code> updates in response to your actions.</p> <p>Now imagine you <em>also</em> want to use the same logic in a different component. You want to implement a Save button that will become disabled and show "Reconnecting..." instead of "Save" while the network is off.</p> <p>To start, you can copy and paste the <code>isOnline</code> state and the Effect into <code>SaveButton</code>:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleSaveClick</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;✅ Progress saved&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>disabled</span><span class=o>=</span><span class=p>{</span><span class=o>!</span><span class=nx>isOnline</span><span class=p>}</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{</span><span class=nx>handleSaveClick</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Save progress&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Reconnecting...&quot;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Verify that, if you turn off the network, the button will change its appearance.</p> <p>These two components work fine, but the duplication in logic between them is unfortunate. It seems like even though they have different <em>visual appearance,</em> you want to reuse the logic between them.</p> <h3 id=extracting-your-own-custom-hook-from-a-component>Extracting your own custom Hook from a component<a class=headerlink href=#extracting-your-own-custom-hook-from-a-component title="Permanent link">&para;</a></h3> <p>Imagine for a moment that, similar to <a href=/reference/react/useState><code>useState</code></a> and <a href=/reference/react/useEffect><code>useEffect</code></a>, there was a built-in <code>useOnlineStatus</code> Hook. Then both of these components could be simplified and you could remove the duplication between them:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;✅ Online&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;❌ Disconnected&quot;</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleSaveClick</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;✅ Progress saved&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>disabled</span><span class=o>=</span><span class=p>{</span><span class=o>!</span><span class=nx>isOnline</span><span class=p>}</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{</span><span class=nx>handleSaveClick</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Save progress&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Reconnecting...&quot;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Although there is no such built-in Hook, you can write it yourself. Declare a function called <code>useOnlineStatus</code> and move all the duplicated code into it from the components you wrote earlier:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>isOnline</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>At the end of the function, return <code>isOnline</code>. This lets your components read that value:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useOnlineStatus.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;✅ Online&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;❌ Disconnected&quot;</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleSaveClick</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;✅ Progress saved&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>disabled</span><span class=o>=</span><span class=p>{</span><span class=o>!</span><span class=nx>isOnline</span><span class=p>}</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{</span><span class=nx>handleSaveClick</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Save progress&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Reconnecting...&quot;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>SaveButton</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>StatusBar</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>isOnline</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Verify that switching the network on and off updates both components.</p> <p>Now your components don't have as much repetitive logic. <strong>More importantly, the code inside them describes <em>what they want to do</em> (use the online status!) rather than <em>how to do it</em> (by subscribing to the browser events).</strong></p> <p>When you extract logic into custom Hooks, you can hide the gnarly details of how you deal with some external system or a browser API. The code of your components expresses your intent, not the implementation.</p> <h3 id=hook-names-always-start-with-use>Hook names always start with <code>use</code><a class=headerlink href=#hook-names-always-start-with-use title="Permanent link">&para;</a></h3> <p>React applications are built from components. Components are built from Hooks, whether built-in or custom. You'll likely often use custom Hooks created by others, but occasionally you might write one yourself!</p> <p>You must follow these naming conventions:</p> <ol> <li><strong>React component names must start with a capital letter,</strong> like <code>StatusBar</code> and <code>SaveButton</code>. React components also need to return something that React knows how to display, like a piece of JSX.</li> <li><strong>Hook names must start with <code>use</code> followed by a capital letter,</strong> like <a href=/reference/react/useState><code>useState</code></a> (built-in) or <code>useOnlineStatus</code> (custom, like earlier on the page). Hooks may return arbitrary values.</li> </ol> <p>This convention guarantees that you can always look at a component and know where its state, Effects, and other React features might "hide". For example, if you see a <code>getColor()</code> function call inside your component, you can be sure that it can't possibly contain React state inside because its name doesn't start with <code>use</code>. However, a function call like <code>useOnlineStatus()</code> will most likely contain calls to other Hooks inside!</p> <p><note></p> <p>If your linter is <a href=/learn/editor-setup#linting>configured for React,</a> it will enforce this naming convention. Scroll up to the sandbox above and rename <code>useOnlineStatus</code> to <code>getOnlineStatus</code>. Notice that the linter won't allow you to call <code>useState</code> or <code>useEffect</code> inside of it anymore. Only Hooks and components can call other Hooks!</p> <p></note></p> <p><deepdive></p> <h4 id=should-all-functions-called-during-rendering-start-with-the-use-prefix>Should all functions called during rendering start with the use prefix?<a class=headerlink href=#should-all-functions-called-during-rendering-start-with-the-use-prefix title="Permanent link">&para;</a></h4> <p>No. Functions that don't <em>call</em> Hooks don't need to <em>be</em> Hooks.</p> <p>If your function doesn't call any Hooks, avoid the <code>use</code> prefix. Instead, write it as a regular function <em>without</em> the <code>use</code> prefix. For example, <code>useSorted</code> below doesn't call Hooks, so call it <code>getSorted</code> instead:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span class=c1>// 🔴 Avoid: A Hook that doesn&#39;t use Hooks</span>
<span class=kd>function</span><span class=w> </span><span class=nx>useSorted</span><span class=p>(</span><span class=nx>items</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>items</span><span class=p>.</span><span class=nx>slice</span><span class=p>().</span><span class=nx>sort</span><span class=p>();</span>
<span class=p>}</span>

<span class=c1>// ✅ Good: A regular function that doesn&#39;t use Hooks</span>
<span class=kd>function</span><span class=w> </span><span class=nx>getSorted</span><span class=p>(</span><span class=nx>items</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>items</span><span class=p>.</span><span class=nx>slice</span><span class=p>().</span><span class=nx>sort</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This ensures that your code can call this regular function anywhere, including conditions:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>List</span><span class=p>({</span><span class=w> </span><span class=nx>items</span><span class=p>,</span><span class=w> </span><span class=nx>shouldSort</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>displayedItems</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>items</span><span class=p>;</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>shouldSort</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// ✅ It&#39;s ok to call getSorted() conditionally because it&#39;s not a Hook</span>
<span class=w>        </span><span class=nx>displayedItems</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>getSorted</span><span class=p>(</span><span class=nx>items</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>You should give <code>use</code> prefix to a function (and thus make it a Hook) if it uses at least one Hook inside of it:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span class=c1>// ✅ Good: A Hook that uses other Hooks</span>
<span class=kd>function</span><span class=w> </span><span class=nx>useAuth</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>useContext</span><span class=p>(</span><span class=nx>Auth</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Technically, this isn't enforced by React. In principle, you could make a Hook that doesn't call other Hooks. This is often confusing and limiting so it's best to avoid that pattern. However, there may be rare cases where it is helpful. For example, maybe your function doesn't use any Hooks right now, but you plan to add some Hook calls to it in the future. Then it makes sense to name it with the <code>use</code> prefix:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span class=c1>// ✅ Good: A Hook that will likely use some other Hooks later</span>
<span class=kd>function</span><span class=w> </span><span class=nx>useAuth</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// TODO: Replace with this line when authentication is implemented:</span>
<span class=w>    </span><span class=c1>// return useContext(Auth);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>TEST_USER</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Then components won't be able to call it conditionally. This will become important when you actually add Hook calls inside. If you don't plan to use Hooks inside it (now or later), don't make it a Hook.</p> <p></deepdive></p> <h3 id=custom-hooks-let-you-share-stateful-logic-not-state-itself>Custom Hooks let you share stateful logic, not state itself<a class=headerlink href=#custom-hooks-let-you-share-stateful-logic-not-state-itself title="Permanent link">&para;</a></h3> <p>In the earlier example, when you turned the network on and off, both components updated together. However, it's wrong to think that a single <code>isOnline</code> state variable is shared between them. Look at this code:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>It works the same way as before you extracted the duplication:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// ...</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// ...</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>These are two completely independent state variables and Effects! They happened to have the same value at the same time because you synchronized them with the same external value (whether the network is on).</p> <p>To better illustrate this, we'll need a different example. Consider this <code>Form</code> component:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Form</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>firstName</span><span class=p>,</span><span class=w> </span><span class=nx>setFirstName</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;Mary&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>lastName</span><span class=p>,</span><span class=w> </span><span class=nx>setLastName</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;Poppins&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleFirstNameChange</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setFirstName</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleLastNameChange</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setLastName</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>First</span><span class=w> </span><span class=nx>name</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>firstName</span><span class=p>}</span><span class=w> </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{</span><span class=nx>handleFirstNameChange</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Last</span><span class=w> </span><span class=nx>name</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>lastName</span><span class=p>}</span><span class=w> </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{</span><span class=nx>handleLastNameChange</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>b</span><span class=o>&gt;</span>
<span class=w>                    </span><span class=nx>Good</span><span class=w> </span><span class=nx>morning</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=nx>firstName</span><span class=p>}</span><span class=w> </span><span class=p>{</span><span class=nx>lastName</span><span class=p>}.</span>
<span class=w>                </span><span class=o>&lt;</span><span class=err>/b&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/p&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>input</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin-left</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>There's some repetitive logic for each form field:</p> <ol> <li>There's a piece of state (<code>firstName</code> and <code>lastName</code>).</li> <li>There's a change handler (<code>handleFirstNameChange</code> and <code>handleLastNameChange</code>).</li> <li>There's a piece of JSX that specifies the <code>value</code> and <code>onChange</code> attributes for that input.</li> </ol> <p>You can extract the repetitive logic into this <code>useFormInput</code> custom Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useFormInput</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useFormInput.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Form</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>firstNameProps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useFormInput</span><span class=p>(</span><span class=s2>&quot;Mary&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>lastNameProps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useFormInput</span><span class=p>(</span><span class=s2>&quot;Poppins&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>First</span><span class=w> </span><span class=nx>name</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span><span class=w> </span><span class=p>{...</span><span class=nx>firstNameProps</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Last</span><span class=w> </span><span class=nx>name</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span><span class=w> </span><span class=p>{...</span><span class=nx>lastNameProps</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>b</span><span class=o>&gt;</span>
<span class=w>                    </span><span class=nx>Good</span><span class=w> </span><span class=nx>morning</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=nx>firstNameProps</span><span class=p>.</span><span class=nx>value</span><span class=p>}</span><span class=w> </span><span class=p>{</span><span class=nx>lastNameProps</span><span class=p>.</span><span class=nx>value</span><span class=p>}.</span>
<span class=w>                </span><span class=o>&lt;</span><span class=err>/b&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/p&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useFormInput</span><span class=p>(</span><span class=nx>initialValue</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>value</span><span class=p>,</span><span class=w> </span><span class=nx>setValue</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=nx>initialValue</span><span class=p>);</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleChange</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setValue</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>inputProps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>value</span><span class=o>:</span><span class=w> </span><span class=nx>value</span><span class=p>,</span>
<span class=w>        </span><span class=nx>onChange</span><span class=o>:</span><span class=w> </span><span class=nx>handleChange</span><span class=p>,</span>
<span class=w>    </span><span class=p>};</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>inputProps</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>input</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin-left</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Notice that it only declares <em>one</em> state variable called <code>value</code>.</p> <p>However, the <code>Form</code> component calls <code>useFormInput</code> <em>two times:</em></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>Form</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>firstNameProps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useFormInput</span><span class=p>(</span><span class=s1>&#39;Mary&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>lastNameProps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useFormInput</span><span class=p>(</span><span class=s1>&#39;Poppins&#39;</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>This is why it works like declaring two separate state variables!</p> <p><strong>Custom Hooks let you share <em>stateful logic</em> but not <em>state itself.</em> Each call to a Hook is completely independent from every other call to the same Hook.</strong> This is why the two sandboxes above are completely equivalent. If you'd like, scroll back up and compare them. The behavior before and after extracting a custom Hook is identical.</p> <p>When you need to share the state itself between multiple components, <a href=/learn/sharing-state-between-components>lift it up and pass it down</a> instead.</p> <h2 id=passing-reactive-values-between-hooks>Passing reactive values between Hooks<a class=headerlink href=#passing-reactive-values-between-hooks title="Permanent link">&para;</a></h2> <p>The code inside your custom Hooks will re-run during every re-render of your component. This is why, like components, custom Hooks <a href=/learn/keeping-components-pure>need to be pure.</a> Think of custom Hooks' code as part of your component's body!</p> <p>Because custom Hooks re-render together with your component, they always receive the latest props and state. To see what this means, consider this chat room example. Change the server URL or the chat room:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>ChatRoom</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./ChatRoom.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>setRoomId</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;general&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Choose</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>chat</span><span class=w> </span><span class=nx>room</span><span class=o>:</span><span class=p>{</span><span class=s2>&quot; &quot;</span><span class=p>}</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>select</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setRoomId</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;general&quot;</span><span class=o>&gt;</span><span class=nx>general</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;travel&quot;</span><span class=o>&gt;</span><span class=nx>travel</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;music&quot;</span><span class=o>&gt;</span><span class=nx>music</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=err>/select&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>ChatRoom</span><span class=w> </span><span class=nx>roomId</span><span class=o>=</span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>createConnection</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./chat.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>showNotification</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./notifications.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>showNotification</span><span class=p>(</span><span class=s2>&quot;New message: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>]);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Server</span><span class=w> </span><span class=nx>URL</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>serverUrl</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Welcome</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=nx>room</span><span class=o>!&lt;</span><span class=err>/h1&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>createConnection</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// A real implementation would actually connect to the server</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=ow>typeof</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;string&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span>
<span class=w>            </span><span class=s2>&quot;Expected serverUrl to be a string. Received: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>serverUrl</span>
<span class=w>        </span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=ow>typeof</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;string&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s2>&quot;Expected roomId to be a string. Received: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>roomId</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>intervalId</span><span class=p>;</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>messageCallback</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>connect</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
<span class=w>                </span><span class=s1>&#39;✅ Connecting to &quot;&#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s1>&#39;&quot; room at &#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;...&quot;</span>
<span class=w>            </span><span class=p>);</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>intervalId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>intervalId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>messageCallback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0.5</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>messageCallback</span><span class=p>(</span><span class=s2>&quot;hey&quot;</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>messageCallback</span><span class=p>(</span><span class=s2>&quot;lol&quot;</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span>
<span class=w>                </span><span class=p>}</span>
<span class=w>            </span><span class=p>},</span><span class=w> </span><span class=mf>3000</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nx>disconnect</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>intervalId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>messageCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>            </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
<span class=w>                </span><span class=s1>&#39;❌ Disconnected from &quot;&#39;</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=nx>roomId</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=s1>&#39;&quot; room at &#39;</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=s2>&quot;&quot;</span>
<span class=w>            </span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nx>on</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>messageCallback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s2>&quot;Cannot add the handler twice.&quot;</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>event</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;message&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>&#39;Only &quot;message&quot; event is supported.&#39;</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>            </span><span class=nx>messageCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>callback</span><span class=p>;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>};</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Toastify</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;toastify-js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=s2>&quot;toastify-js/src/toastify.css&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>showNotification</span><span class=p>(</span><span class=nx>message</span><span class=p>,</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Toastify</span><span class=p>({</span>
<span class=w>        </span><span class=nx>text</span><span class=o>:</span><span class=w> </span><span class=nx>message</span><span class=p>,</span>
<span class=w>        </span><span class=nx>duration</span><span class=o>:</span><span class=w> </span><span class=mf>2000</span><span class=p>,</span>
<span class=w>        </span><span class=nx>gravity</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;top&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>position</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;right&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>style</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>background</span><span class=o>:</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;black&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;white&quot;</span><span class=p>,</span>
<span class=w>            </span><span class=nx>color</span><span class=o>:</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;white&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;black&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>}).</span><span class=nx>showToast</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;react&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-dom&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;toastify-js&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.12.0&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;start&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts start&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;build&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts build&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;test&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts test --env=jsdom&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;eject&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts eject&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>input</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin-left</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>When you change <code>serverUrl</code> or <code>roomId</code>, the Effect <a href=/learn/lifecycle-of-reactive-effects#effects-react-to-reactive-values>"reacts" to your changes</a> and re-synchronizes. You can tell by the console messages that the chat re-connects every time that you change your Effect's dependencies.</p> <p>Now move the Effect's code into a custom Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>showNotification</span><span class=p>(</span><span class=s2>&quot;New message: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This lets your <code>ChatRoom</code> component call your custom Hook without worrying about how it works inside:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useChatRoom</span><span class=p>({</span>
<span class=w>        </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>    </span><span class=p>});</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Server</span><span class=w> </span><span class=nx>URL</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>serverUrl</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Welcome</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=nx>room</span><span class=o>!&lt;</span><span class=err>/h1&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This looks much simpler! (But it does the same thing.)</p> <p>Notice that the logic <em>still responds</em> to prop and state changes. Try editing the server URL or the selected room:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>ChatRoom</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./ChatRoom.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>setRoomId</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;general&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Choose</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>chat</span><span class=w> </span><span class=nx>room</span><span class=o>:</span><span class=p>{</span><span class=s2>&quot; &quot;</span><span class=p>}</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>select</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setRoomId</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;general&quot;</span><span class=o>&gt;</span><span class=nx>general</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;travel&quot;</span><span class=o>&gt;</span><span class=nx>travel</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;music&quot;</span><span class=o>&gt;</span><span class=nx>music</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=err>/select&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>ChatRoom</span><span class=w> </span><span class=nx>roomId</span><span class=o>=</span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useChatRoom</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useChatRoom.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useChatRoom</span><span class=p>({</span>
<span class=w>        </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>    </span><span class=p>});</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Server</span><span class=w> </span><span class=nx>URL</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>serverUrl</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Welcome</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=nx>room</span><span class=o>!&lt;</span><span class=err>/h1&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>createConnection</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./chat.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>showNotification</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./notifications.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>showNotification</span><span class=p>(</span><span class=s2>&quot;New message: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>createConnection</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// A real implementation would actually connect to the server</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=ow>typeof</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;string&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span>
<span class=w>            </span><span class=s2>&quot;Expected serverUrl to be a string. Received: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>serverUrl</span>
<span class=w>        </span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=ow>typeof</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;string&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s2>&quot;Expected roomId to be a string. Received: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>roomId</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>intervalId</span><span class=p>;</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>messageCallback</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>connect</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
<span class=w>                </span><span class=s1>&#39;✅ Connecting to &quot;&#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s1>&#39;&quot; room at &#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;...&quot;</span>
<span class=w>            </span><span class=p>);</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>intervalId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>intervalId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>messageCallback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0.5</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>messageCallback</span><span class=p>(</span><span class=s2>&quot;hey&quot;</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>messageCallback</span><span class=p>(</span><span class=s2>&quot;lol&quot;</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span>
<span class=w>                </span><span class=p>}</span>
<span class=w>            </span><span class=p>},</span><span class=w> </span><span class=mf>3000</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nx>disconnect</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>intervalId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>messageCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>            </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
<span class=w>                </span><span class=s1>&#39;❌ Disconnected from &quot;&#39;</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=nx>roomId</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=s1>&#39;&quot; room at &#39;</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=s2>&quot;&quot;</span>
<span class=w>            </span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nx>on</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>messageCallback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s2>&quot;Cannot add the handler twice.&quot;</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>event</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;message&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>&#39;Only &quot;message&quot; event is supported.&#39;</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>            </span><span class=nx>messageCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>callback</span><span class=p>;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>};</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Toastify</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;toastify-js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=s2>&quot;toastify-js/src/toastify.css&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>showNotification</span><span class=p>(</span><span class=nx>message</span><span class=p>,</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Toastify</span><span class=p>({</span>
<span class=w>        </span><span class=nx>text</span><span class=o>:</span><span class=w> </span><span class=nx>message</span><span class=p>,</span>
<span class=w>        </span><span class=nx>duration</span><span class=o>:</span><span class=w> </span><span class=mf>2000</span><span class=p>,</span>
<span class=w>        </span><span class=nx>gravity</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;top&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>position</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;right&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>style</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>background</span><span class=o>:</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;black&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;white&quot;</span><span class=p>,</span>
<span class=w>            </span><span class=nx>color</span><span class=o>:</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;white&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;black&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>}).</span><span class=nx>showToast</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;react&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-dom&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;toastify-js&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.12.0&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;start&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts start&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;build&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts build&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;test&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts test --env=jsdom&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;eject&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts eject&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>input</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin-left</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Notice how you're taking the return value of one Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;https://localhost:1234&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=nx>useChatRoom</span><span class=p>({</span>
<span class=w>    </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>    </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span>
<span class=w>  </span><span class=p>});</span>
<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>and pass it as an input to another Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;https://localhost:1234&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=nx>useChatRoom</span><span class=p>({</span>
<span class=w>    </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>    </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span>
<span class=w>  </span><span class=p>});</span>
<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>Every time your <code>ChatRoom</code> component re-renders, it passes the latest <code>roomId</code> and <code>serverUrl</code> to your Hook. This is why your Effect re-connects to the chat whenever their values are different after a re-render. (If you ever worked with audio or video processing software, chaining Hooks like this might remind you of chaining visual or audio effects. It's as if the output of <code>useState</code> "feeds into" the input of the <code>useChatRoom</code>.)</p> <h3 id=passing-event-handlers-to-custom-hooks>Passing event handlers to custom Hooks<a class=headerlink href=#passing-event-handlers-to-custom-hooks title="Permanent link">&para;</a></h3> <p><wip></p> <p>This section describes an <strong>experimental API that has not yet been released</strong> in a stable version of React.</p> <p></wip></p> <p>As you start using <code>useChatRoom</code> in more components, you might want to let components customize its behavior. For example, currently, the logic for what to do when a message arrives is hardcoded inside the Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>showNotification</span><span class=p>(</span><span class=s2>&quot;New message: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Let's say you want to move this logic back to your component:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s1>&#39;https://localhost:1234&#39;</span><span class=p>);</span>

<span class=w>  </span><span class=nx>useChatRoom</span><span class=p>({</span>
<span class=w>    </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>    </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>    </span><span class=nx>onReceiveMessage</span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>showNotification</span><span class=p>(</span><span class=s1>&#39;New message: &#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>msg</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>});</span>
<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>To make this work, change your custom Hook to take <code>onReceiveMessage</code> as one of its named options:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>onReceiveMessage</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>onReceiveMessage</span><span class=p>(</span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>onReceiveMessage</span><span class=p>]);</span><span class=w> </span><span class=c1>// ✅ All dependencies declared</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This will work, but there's one more improvement you can do when your custom Hook accepts event handlers.</p> <p>Adding a dependency on <code>onReceiveMessage</code> is not ideal because it will cause the chat to re-connect every time the component re-renders. <a href=/learn/removing-effect-dependencies#wrapping-an-event-handler-from-the-props>Wrap this event handler into an Effect Event to remove it from the dependencies:</a></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=p>,</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=c1>// ...</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>onReceiveMessage</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>onMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=p>(</span><span class=nx>onReceiveMessage</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>onMessage</span><span class=p>(</span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>]);</span><span class=w> </span><span class=c1>// ✅ All dependencies declared</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Now the chat won't re-connect every time that the <code>ChatRoom</code> component re-renders. Here is a fully working demo of passing an event handler to a custom Hook that you can play with:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>ChatRoom</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./ChatRoom.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>setRoomId</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;general&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Choose</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=nx>chat</span><span class=w> </span><span class=nx>room</span><span class=o>:</span><span class=p>{</span><span class=s2>&quot; &quot;</span><span class=p>}</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>select</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setRoomId</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;general&quot;</span><span class=o>&gt;</span><span class=nx>general</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;travel&quot;</span><span class=o>&gt;</span><span class=nx>travel</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                    </span><span class=o>&lt;</span><span class=nx>option</span><span class=w> </span><span class=nx>value</span><span class=o>=</span><span class=s2>&quot;music&quot;</span><span class=o>&gt;</span><span class=nx>music</span><span class=o>&lt;</span><span class=err>/option&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=err>/select&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>ChatRoom</span><span class=w> </span><span class=nx>roomId</span><span class=o>=</span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useChatRoom</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useChatRoom.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>showNotification</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./notifications.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useChatRoom</span><span class=p>({</span>
<span class=w>        </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>        </span><span class=nx>onReceiveMessage</span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>showNotification</span><span class=p>(</span><span class=s2>&quot;New message: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>});</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Server</span><span class=w> </span><span class=nx>URL</span><span class=o>:</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>serverUrl</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
<span class=w>                </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Welcome</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>the</span><span class=w> </span><span class=p>{</span><span class=nx>roomId</span><span class=p>}</span><span class=w> </span><span class=nx>room</span><span class=o>!&lt;</span><span class=err>/h1&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>experimental_useEffectEvent</span><span class=w> </span><span class=kr>as</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>createConnection</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./chat.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>onReceiveMessage</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>onMessage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=p>(</span><span class=nx>onReceiveMessage</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>options</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>serverUrl</span><span class=o>:</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span>
<span class=w>            </span><span class=nx>roomId</span><span class=o>:</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s2>&quot;message&quot;</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>msg</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>onMessage</span><span class=p>(</span><span class=nx>msg</span><span class=p>);</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>createConnection</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// A real implementation would actually connect to the server</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=ow>typeof</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;string&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span>
<span class=w>            </span><span class=s2>&quot;Expected serverUrl to be a string. Received: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>serverUrl</span>
<span class=w>        </span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=ow>typeof</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;string&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s2>&quot;Expected roomId to be a string. Received: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>roomId</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>intervalId</span><span class=p>;</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>messageCallback</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>connect</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
<span class=w>                </span><span class=s1>&#39;✅ Connecting to &quot;&#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s1>&#39;&quot; room at &#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;...&quot;</span>
<span class=w>            </span><span class=p>);</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>intervalId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>intervalId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>messageCallback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>0.5</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>messageCallback</span><span class=p>(</span><span class=s2>&quot;hey&quot;</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>messageCallback</span><span class=p>(</span><span class=s2>&quot;lol&quot;</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span>
<span class=w>                </span><span class=p>}</span>
<span class=w>            </span><span class=p>},</span><span class=w> </span><span class=mf>3000</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nx>disconnect</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>intervalId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>messageCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>            </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
<span class=w>                </span><span class=s1>&#39;❌ Disconnected from &quot;&#39;</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=nx>roomId</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=s1>&#39;&quot; room at &#39;</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=nx>serverUrl</span><span class=w> </span><span class=o>+</span>
<span class=w>                    </span><span class=s2>&quot;&quot;</span>
<span class=w>            </span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nx>on</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>messageCallback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s2>&quot;Cannot add the handler twice.&quot;</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>event</span><span class=w> </span><span class=o>!==</span><span class=w> </span><span class=s2>&quot;message&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>&#39;Only &quot;message&quot; event is supported.&#39;</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>            </span><span class=nx>messageCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>callback</span><span class=p>;</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>};</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Toastify</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;toastify-js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=s2>&quot;toastify-js/src/toastify.css&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>showNotification</span><span class=p>(</span><span class=nx>message</span><span class=p>,</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Toastify</span><span class=p>({</span>
<span class=w>        </span><span class=nx>text</span><span class=o>:</span><span class=w> </span><span class=nx>message</span><span class=p>,</span>
<span class=w>        </span><span class=nx>duration</span><span class=o>:</span><span class=w> </span><span class=mf>2000</span><span class=p>,</span>
<span class=w>        </span><span class=nx>gravity</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;top&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>position</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;right&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>style</span><span class=o>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>background</span><span class=o>:</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;black&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;white&quot;</span><span class=p>,</span>
<span class=w>            </span><span class=nx>color</span><span class=o>:</span><span class=w> </span><span class=nx>theme</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=s2>&quot;dark&quot;</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;white&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;black&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>}).</span><span class=nx>showToast</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;react&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-dom&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;toastify-js&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;1.12.0&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;start&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts start&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;build&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts build&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;test&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts test --env=jsdom&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;eject&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts eject&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>input</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin-left</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Notice how you no longer need to know <em>how</em> <code>useChatRoom</code> works in order to use it. You could add it to any other component, pass any other options, and it would work the same way. That's the power of custom Hooks.</p> <h2 id=when-to-use-custom-hooks>When to use custom Hooks<a class=headerlink href=#when-to-use-custom-hooks title="Permanent link">&para;</a></h2> <p>You don't need to extract a custom Hook for every little duplicated bit of code. Some duplication is fine. For example, extracting a <code>useFormInput</code> Hook to wrap a single <code>useState</code> call like earlier is probably unnecessary.</p> <p>However, whenever you write an Effect, consider whether it would be clearer to also wrap it in a custom Hook. <a href=/learn/you-might-not-need-an-effect>You shouldn't need Effects very often,</a> so if you're writing one, it means that you need to "step outside React" to synchronize with some external system or to do something that React doesn't have a built-in API for. Wrapping it into a custom Hook lets you precisely communicate your intent and how the data flows through it.</p> <p>For example, consider a <code>ShippingForm</code> component that displays two dropdowns: one shows the list of cities, and another shows the list of areas in the selected city. You might start with some code that looks like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>ShippingForm</span><span class=p>({</span><span class=w> </span><span class=nx>country</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>cities</span><span class=p>,</span><span class=w> </span><span class=nx>setCities</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// This Effect fetches cities for a country</span>
<span class=w>  </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>ignore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span>
<span class=w>    </span><span class=nx>fetch</span><span class=p>(</span><span class=sb>`/api/cities?country=</span><span class=si>${</span><span class=nx>country</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
<span class=w>      </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
<span class=w>      </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>json</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>ignore</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=nx>setCities</span><span class=p>(</span><span class=nx>json</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>      </span><span class=p>});</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>ignore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span>
<span class=w>    </span><span class=p>};</span>
<span class=w>  </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>country</span><span class=p>]);</span>

<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>city</span><span class=p>,</span><span class=w> </span><span class=nx>setCity</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>areas</span><span class=p>,</span><span class=w> </span><span class=nx>setAreas</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// This Effect fetches areas for the selected city</span>
<span class=w>  </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>city</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kd>let</span><span class=w> </span><span class=nx>ignore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span>
<span class=w>      </span><span class=nx>fetch</span><span class=p>(</span><span class=sb>`/api/areas?city=</span><span class=si>${</span><span class=nx>city</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
<span class=w>        </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
<span class=w>        </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>json</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>          </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>ignore</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setAreas</span><span class=p>(</span><span class=nx>json</span><span class=p>);</span>
<span class=w>          </span><span class=p>}</span>
<span class=w>        </span><span class=p>});</span>
<span class=w>      </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>ignore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span>
<span class=w>      </span><span class=p>};</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>city</span><span class=p>]);</span>

<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>Although this code is quite repetitive, <a href=/learn/removing-effect-dependencies#is-your-effect-doing-several-unrelated-things>it's correct to keep these Effects separate from each other.</a> They synchronize two different things, so you shouldn't merge them into one Effect. Instead, you can simplify the <code>ShippingForm</code> component above by extracting the common logic between them into your own <code>useData</code> Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>useData</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>data</span><span class=p>,</span><span class=w> </span><span class=nx>setData</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>url</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kd>let</span><span class=w> </span><span class=nx>ignore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span>
<span class=w>            </span><span class=nx>fetch</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span>
<span class=w>                </span><span class=p>.</span><span class=nx>then</span><span class=p>((</span><span class=nx>response</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
<span class=w>                </span><span class=p>.</span><span class=nx>then</span><span class=p>((</span><span class=nx>json</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>ignore</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>setData</span><span class=p>(</span><span class=nx>json</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span>
<span class=w>                </span><span class=p>});</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nx>ignore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span>
<span class=w>            </span><span class=p>};</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>url</span><span class=p>]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>data</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Now you can replace both Effects in the <code>ShippingForm</code> components with calls to <code>useData</code>:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>ShippingForm</span><span class=p>({</span><span class=w> </span><span class=nx>country</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>cities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useData</span><span class=p>(</span><span class=sb>`/api/cities?country=</span><span class=si>${</span><span class=nx>country</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>city</span><span class=p>,</span><span class=w> </span><span class=nx>setCity</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>areas</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useData</span><span class=p>(</span><span class=nx>city</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=sb>`/api/areas?city=</span><span class=si>${</span><span class=nx>city</span><span class=si>}</span><span class=sb>`</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kc>null</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>Extracting a custom Hook makes the data flow explicit. You feed the <code>url</code> in and you get the <code>data</code> out. By "hiding" your Effect inside <code>useData</code>, you also prevent someone working on the <code>ShippingForm</code> component from adding <a href=/learn/removing-effect-dependencies>unnecessary dependencies</a> to it. With time, most of your app's Effects will be in custom Hooks.</p> <p><deepdive></p> <h4 id=keep-your-custom-hooks-focused-on-concrete-high-level-use-cases>Keep your custom Hooks focused on concrete high-level use cases<a class=headerlink href=#keep-your-custom-hooks-focused-on-concrete-high-level-use-cases title="Permanent link">&para;</a></h4> <p>Start by choosing your custom Hook's name. If you struggle to pick a clear name, it might mean that your Effect is too coupled to the rest of your component's logic, and is not yet ready to be extracted.</p> <p>Ideally, your custom Hook's name should be clear enough that even a person who doesn't write code often could have a good guess about what your custom Hook does, what it takes, and what it returns:</p> <ul> <li>✅ <code>useData(url)</code></li> <li>✅ <code>useImpressionLog(eventName, extraData)</code></li> <li>✅ <code>useChatRoom(options)</code></li> </ul> <p>When you synchronize with an external system, your custom Hook name may be more technical and use jargon specific to that system. It's good as long as it would be clear to a person familiar with that system:</p> <ul> <li>✅ <code>useMediaQuery(query)</code></li> <li>✅ <code>useSocket(url)</code></li> <li>✅ <code>useIntersectionObserver(ref, options)</code></li> </ul> <p><strong>Keep custom Hooks focused on concrete high-level use cases.</strong> Avoid creating and using custom "lifecycle" Hooks that act as alternatives and convenience wrappers for the <code>useEffect</code> API itself:</p> <ul> <li>🔴 <code>useMount(fn)</code></li> <li>🔴 <code>useEffectOnce(fn)</code></li> <li>🔴 <code>useUpdateEffect(fn)</code></li> </ul> <p>For example, this <code>useMount</code> Hook tries to ensure some code only runs "on mount":</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=c1>// 🔴 Avoid: using custom &quot;lifecycle&quot; Hooks</span>
<span class=w>    </span><span class=nx>useMount</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=p>,</span><span class=w> </span><span class=nx>serverUrl</span><span class=w> </span><span class=p>});</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>

<span class=w>        </span><span class=nx>post</span><span class=p>(</span><span class=s2>&quot;/analytics/event&quot;</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>eventName</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;visit_chat&quot;</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>

<span class=c1>// 🔴 Avoid: creating custom &quot;lifecycle&quot; Hooks</span>
<span class=kd>function</span><span class=w> </span><span class=nx>useMount</span><span class=p>(</span><span class=nx>fn</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>fn</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span><span class=w> </span><span class=c1>// 🔴 React Hook useEffect has a missing dependency: &#39;fn&#39;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><strong>Custom "lifecycle" Hooks like <code>useMount</code> don't fit well into the React paradigm.</strong> For example, this code example has a mistake (it doesn't "react" to <code>roomId</code> or <code>serverUrl</code> changes), but the linter won't warn you about it because the linter only checks direct <code>useEffect</code> calls. It won't know about your Hook.</p> <p>If you're writing an Effect, start by using the React API directly:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=c1>// ✅ Good: two raw Effects separated by purpose</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>createConnection</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>});</span>
<span class=w>        </span><span class=nx>connection</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>connection</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=p>]);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>post</span><span class=p>(</span><span class=s2>&quot;/analytics/event&quot;</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>eventName</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;visit_chat&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>roomId</span><span class=p>]);</span>

<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Then, you can (but don't have to) extract custom Hooks for different high-level use cases:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>ChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>setServerUrl</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=s2>&quot;https://localhost:1234&quot;</span><span class=p>);</span>

<span class=w>    </span><span class=c1>// ✅ Great: custom Hooks named after their purpose</span>
<span class=w>    </span><span class=nx>useChatRoom</span><span class=p>({</span><span class=w> </span><span class=nx>serverUrl</span><span class=p>,</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=nx>useImpressionLog</span><span class=p>(</span><span class=s2>&quot;visit_chat&quot;</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>roomId</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><strong>A good custom Hook makes the calling code more declarative by constraining what it does.</strong> For example, <code>useChatRoom(options)</code> can only connect to the chat room, while <code>useImpressionLog(eventName, extraData)</code> can only send an impression log to the analytics. If your custom Hook API doesn't constrain the use cases and is very abstract, in the long run it's likely to introduce more problems than it solves.</p> <p></deepdive></p> <h3 id=custom-hooks-help-you-migrate-to-better-patterns>Custom Hooks help you migrate to better patterns<a class=headerlink href=#custom-hooks-help-you-migrate-to-better-patterns title="Permanent link">&para;</a></h3> <p>Effects are an <a href=/learn/escape-hatches>"escape hatch"</a>: you use them when you need to "step outside React" and when there is no better built-in solution for your use case. With time, the React team's goal is to reduce the number of the Effects in your app to the minimum by providing more specific solutions to more specific problems. Wrapping your Effects in custom Hooks makes it easier to upgrade your code when these solutions become available.</p> <p>Let's return to this example:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useOnlineStatus.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;✅ Online&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;❌ Disconnected&quot;</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleSaveClick</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;✅ Progress saved&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>disabled</span><span class=o>=</span><span class=p>{</span><span class=o>!</span><span class=nx>isOnline</span><span class=p>}</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{</span><span class=nx>handleSaveClick</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Save progress&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Reconnecting...&quot;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>SaveButton</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>StatusBar</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isOnline</span><span class=p>,</span><span class=w> </span><span class=nx>setIsOnline</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsOnline</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOnline</span><span class=p>);</span>
<span class=w>            </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleOffline</span><span class=p>);</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>isOnline</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>In the above example, <code>useOnlineStatus</code> is implemented with a pair of <a href=/reference/react/useState><code>useState</code></a> and <a href=/reference/react/useEffect><code>useEffect</code>.</a> However, this isn't the best possible solution. There is a number of edge cases it doesn't consider. For example, it assumes that when the component mounts, <code>isOnline</code> is already <code>true</code>, but this may be wrong if the network already went offline. You can use the browser <a href=https://developer.mozilla.org/en-US/docs/Web/API/Navigator/onLine><code>navigator.onLine</code></a> API to check for that, but using it directly would not work on the server for generating the initial HTML. In short, this code could be improved.</p> <p>Luckily, React 18 includes a dedicated API called <a href=/reference/react/useSyncExternalStore><code>useSyncExternalStore</code></a> which takes care of all of these problems for you. Here is how your <code>useOnlineStatus</code> Hook, rewritten to take advantage of this new API:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useOnlineStatus.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;✅ Online&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;❌ Disconnected&quot;</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>

<span class=w>    </span><span class=kd>function</span><span class=w> </span><span class=nx>handleSaveClick</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;✅ Progress saved&quot;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>disabled</span><span class=o>=</span><span class=p>{</span><span class=o>!</span><span class=nx>isOnline</span><span class=p>}</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{</span><span class=nx>handleSaveClick</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>isOnline</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Save progress&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Reconnecting...&quot;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>SaveButton</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>StatusBar</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useSyncExternalStore</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>subscribe</span><span class=p>(</span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>);</span>
<span class=w>    </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;online&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>);</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;offline&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>);</span>
<span class=w>    </span><span class=p>};</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>useSyncExternalStore</span><span class=p>(</span>
<span class=w>        </span><span class=nx>subscribe</span><span class=p>,</span>
<span class=w>        </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>navigator</span><span class=p>.</span><span class=nx>onLine</span><span class=p>,</span><span class=w> </span><span class=c1>// How to get the value on the client</span>
<span class=w>        </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=c1>// How to get the value on the server</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Notice how <strong>you didn't need to change any of the components</strong> to make this migration:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>StatusBar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>SaveButton</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>isOnline</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useOnlineStatus</span><span class=p>();</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This is another reason for why wrapping Effects in custom Hooks is often beneficial:</p> <ol> <li>You make the data flow to and from your Effects very explicit.</li> <li>You let your components focus on the intent rather than on the exact implementation of your Effects.</li> <li>When React adds new features, you can remove those Effects without changing any of your components.</li> </ol> <p>Similar to a <a href=https://uxdesign.cc/everything-you-need-to-know-about-design-systems-54b109851969>design system,</a> you might find it helpful to start extracting common idioms from your app's components into custom Hooks. This will keep your components' code focused on the intent, and let you avoid writing raw Effects very often. Many excellent custom Hooks are maintained by the React community.</p> <p><deepdive></p> <h4 id=will-react-provide-any-built-in-solution-for-data-fetching>Will React provide any built-in solution for data fetching?<a class=headerlink href=#will-react-provide-any-built-in-solution-for-data-fetching title="Permanent link">&para;</a></h4> <p>We're still working out the details, but we expect that in the future, you'll write data fetching like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>use</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s1>&#39;react&#39;</span><span class=p>;</span><span class=w> </span><span class=c1>// Not available yet!</span>

<span class=kd>function</span><span class=w> </span><span class=nx>ShippingForm</span><span class=p>({</span><span class=w> </span><span class=nx>country</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>cities</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>use</span><span class=p>(</span><span class=nx>fetch</span><span class=p>(</span><span class=sb>`/api/cities?country=</span><span class=si>${</span><span class=nx>country</span><span class=si>}</span><span class=sb>`</span><span class=p>));</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>city</span><span class=p>,</span><span class=w> </span><span class=nx>setCity</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>areas</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>city</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=nx>use</span><span class=p>(</span><span class=nx>fetch</span><span class=p>(</span><span class=sb>`/api/areas?city=</span><span class=si>${</span><span class=nx>city</span><span class=si>}</span><span class=sb>`</span><span class=p>))</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>  </span><span class=c1>// ...</span>
</code></pre></div></td></tr></table></div> <p>If you use custom Hooks like <code>useData</code> above in your app, it will require fewer changes to migrate to the eventually recommended approach than if you write raw Effects in every component manually. However, the old approach will still work fine, so if you feel happy writing raw Effects, you can continue to do that.</p> <p></deepdive></p> <h3 id=there-is-more-than-one-way-to-do-it>There is more than one way to do it<a class=headerlink href=#there-is-more-than-one-way-to-do-it title="Permanent link">&para;</a></h3> <p>Let's say you want to implement a fade-in animation <em>from scratch</em> using the browser <a href=https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame><code>requestAnimationFrame</code></a> API. You might start with an Effect that sets up an animation loop. During each frame of the animation, you could change the opacity of the DOM node you <a href=/learn/manipulating-the-dom-with-refs>hold in a ref</a> until it reaches <code>1</code>. Your code might start like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=p>,</span><span class=w> </span><span class=nx>useRef</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Welcome</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>duration</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1000</span><span class=p>;</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>ref</span><span class=p>.</span><span class=nx>current</span><span class=p>;</span>

<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>onFrame</span><span class=p>(</span><span class=nx>now</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kd>const</span><span class=w> </span><span class=nx>timePassed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>now</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>startTime</span><span class=p>;</span>
<span class=w>            </span><span class=kd>const</span><span class=w> </span><span class=nx>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>timePassed</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nx>duration</span><span class=p>,</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>            </span><span class=nx>onProgress</span><span class=p>(</span><span class=nx>progress</span><span class=p>);</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>progress</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=c1>// We still have more frames to paint</span>
<span class=w>                </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>onFrame</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>onProgress</span><span class=p>(</span><span class=nx>progress</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>node</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>progress</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>start</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>onProgress</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>            </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
<span class=w>            </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>onFrame</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>stop</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>cancelAnimationFrame</span><span class=p>(</span><span class=nx>frameId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>            </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=nx>start</span><span class=p>();</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>stop</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;welcome&quot;</span><span class=w> </span><span class=nx>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=nx>Welcome</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>show</span><span class=p>,</span><span class=w> </span><span class=nx>setShow</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setShow</span><span class=p>(</span><span class=o>!</span><span class=nx>show</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Remove&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Show&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Welcome</span><span class=w> </span><span class=o>/&gt;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=o>,</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>html</span><span class=o>,</span>
<span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>welcome</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>opacity</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=kc>white</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>text-align</span><span class=p>:</span><span class=w> </span><span class=kc>center</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>background-image</span><span class=p>:</span><span class=w> </span><span class=nb>radial-gradient</span><span class=p>(</span>
<span class=w>        </span><span class=kc>circle</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>63</span><span class=p>,</span><span class=w> </span><span class=mi>94</span><span class=p>,</span><span class=w> </span><span class=mi>251</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>0</span><span class=kt>%</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>252</span><span class=p>,</span><span class=w> </span><span class=mi>70</span><span class=p>,</span><span class=w> </span><span class=mi>107</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>To make the component more readable, you might extract the logic into a <code>useFadeIn</code> custom Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=p>,</span><span class=w> </span><span class=nx>useRef</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useFadeIn</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useFadeIn.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Welcome</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useFadeIn</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;welcome&quot;</span><span class=w> </span><span class=nx>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=nx>Welcome</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>show</span><span class=p>,</span><span class=w> </span><span class=nx>setShow</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setShow</span><span class=p>(</span><span class=o>!</span><span class=nx>show</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Remove&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Show&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Welcome</span><span class=w> </span><span class=o>/&gt;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useFadeIn</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>ref</span><span class=p>.</span><span class=nx>current</span><span class=p>;</span>

<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>onFrame</span><span class=p>(</span><span class=nx>now</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kd>const</span><span class=w> </span><span class=nx>timePassed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>now</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>startTime</span><span class=p>;</span>
<span class=w>            </span><span class=kd>const</span><span class=w> </span><span class=nx>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>timePassed</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nx>duration</span><span class=p>,</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>            </span><span class=nx>onProgress</span><span class=p>(</span><span class=nx>progress</span><span class=p>);</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>progress</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=c1>// We still have more frames to paint</span>
<span class=w>                </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>onFrame</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>onProgress</span><span class=p>(</span><span class=nx>progress</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>node</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>progress</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>start</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>onProgress</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>            </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
<span class=w>            </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>onFrame</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>stop</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>cancelAnimationFrame</span><span class=p>(</span><span class=nx>frameId</span><span class=p>);</span>
<span class=w>            </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>            </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=nx>start</span><span class=p>();</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>stop</span><span class=p>();</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=o>,</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>html</span><span class=o>,</span>
<span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>welcome</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>opacity</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=kc>white</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>text-align</span><span class=p>:</span><span class=w> </span><span class=kc>center</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>background-image</span><span class=p>:</span><span class=w> </span><span class=nb>radial-gradient</span><span class=p>(</span>
<span class=w>        </span><span class=kc>circle</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>63</span><span class=p>,</span><span class=w> </span><span class=mi>94</span><span class=p>,</span><span class=w> </span><span class=mi>251</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>0</span><span class=kt>%</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>252</span><span class=p>,</span><span class=w> </span><span class=mi>70</span><span class=p>,</span><span class=w> </span><span class=mi>107</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>You could keep the <code>useFadeIn</code> code as is, but you could also refactor it more. For example, you could extract the logic for setting up the animation loop out of <code>useFadeIn</code> into a custom <code>useAnimationLoop</code> Hook:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=p>,</span><span class=w> </span><span class=nx>useRef</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useFadeIn</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useFadeIn.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Welcome</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useFadeIn</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;welcome&quot;</span><span class=w> </span><span class=nx>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=nx>Welcome</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>show</span><span class=p>,</span><span class=w> </span><span class=nx>setShow</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setShow</span><span class=p>(</span><span class=o>!</span><span class=nx>show</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Remove&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Show&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Welcome</span><span class=w> </span><span class=o>/&gt;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>experimental_useEffectEvent</span><span class=w> </span><span class=kr>as</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useFadeIn</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>isRunning</span><span class=p>,</span><span class=w> </span><span class=nx>setIsRunning</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useAnimationLoop</span><span class=p>(</span><span class=nx>isRunning</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>timePassed</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>timePassed</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nx>duration</span><span class=p>,</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=nx>ref</span><span class=p>.</span><span class=nx>current</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>progress</span><span class=p>;</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>progress</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=mf>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setIsRunning</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>});</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useAnimationLoop</span><span class=p>(</span><span class=nx>isRunning</span><span class=p>,</span><span class=w> </span><span class=nx>drawFrame</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>onFrame</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=p>(</span><span class=nx>drawFrame</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=nx>isRunning</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=p>;</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
<span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>

<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>tick</span><span class=p>(</span><span class=nx>now</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=kd>const</span><span class=w> </span><span class=nx>timePassed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>now</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nx>startTime</span><span class=p>;</span>
<span class=w>            </span><span class=nx>onFrame</span><span class=p>(</span><span class=nx>timePassed</span><span class=p>);</span>
<span class=w>            </span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(</span><span class=nx>tick</span><span class=p>);</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=nx>tick</span><span class=p>();</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>cancelAnimationFrame</span><span class=p>(</span><span class=nx>frameId</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>isRunning</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=o>,</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>html</span><span class=o>,</span>
<span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>welcome</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>opacity</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=kc>white</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>text-align</span><span class=p>:</span><span class=w> </span><span class=kc>center</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>background-image</span><span class=p>:</span><span class=w> </span><span class=nb>radial-gradient</span><span class=p>(</span>
<span class=w>        </span><span class=kc>circle</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>63</span><span class=p>,</span><span class=w> </span><span class=mi>94</span><span class=p>,</span><span class=w> </span><span class=mi>251</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>0</span><span class=kt>%</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>252</span><span class=p>,</span><span class=w> </span><span class=mi>70</span><span class=p>,</span><span class=w> </span><span class=mi>107</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;react&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-dom&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;start&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts start&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;build&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts build&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;test&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts test --env=jsdom&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;eject&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts eject&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>However, you didn't <em>have to</em> do that. As with regular functions, ultimately you decide where to draw the boundaries between different parts of your code. You could also take a very different approach. Instead of keeping the logic in the Effect, you could move most of the imperative logic inside a JavaScript <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes>class:</a></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=p>,</span><span class=w> </span><span class=nx>useRef</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useFadeIn</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useFadeIn.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Welcome</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useRef</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useFadeIn</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;welcome&quot;</span><span class=w> </span><span class=nx>ref</span><span class=o>=</span><span class=p>{</span><span class=nx>ref</span><span class=p>}</span><span class=o>&gt;</span>
<span class=w>            </span><span class=nx>Welcome</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>show</span><span class=p>,</span><span class=w> </span><span class=nx>setShow</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setShow</span><span class=p>(</span><span class=o>!</span><span class=nx>show</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Remove&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Show&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Welcome</span><span class=w> </span><span class=o>/&gt;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>FadeInAnimation</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./animation.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useFadeIn</span><span class=p>(</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>FadeInAnimation</span><span class=p>(</span><span class=nx>ref</span><span class=p>.</span><span class=nx>current</span><span class=p>);</span>
<span class=w>        </span><span class=nx>animation</span><span class=p>.</span><span class=nx>start</span><span class=p>(</span><span class=nx>duration</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>animation</span><span class=p>.</span><span class=nx>stop</span><span class=p>();</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>ref</span><span class=p>,</span><span class=w> </span><span class=nx>duration</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nx>FadeInAnimation</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kr>constructor</span><span class=p>(</span><span class=nx>node</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>node</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>start</span><span class=p>(</span><span class=nx>duration</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>duration</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>duration</span><span class=p>;</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>onProgress</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=nx>onFrame</span><span class=p>());</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>onFrame</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>timePassed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=nx>startTime</span><span class=p>;</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>timePassed</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=nx>duration</span><span class=p>,</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>onProgress</span><span class=p>(</span><span class=nx>progress</span><span class=p>);</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>progress</span><span class=w> </span><span class=o>===</span><span class=w> </span><span class=mf>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=nx>stop</span><span class=p>();</span>
<span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=c1>// We still have more frames to paint</span>
<span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>requestAnimationFrame</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=nx>onFrame</span><span class=p>());</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>onProgress</span><span class=p>(</span><span class=nx>progress</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>node</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>progress</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>stop</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>cancelAnimationFrame</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>frameId</span><span class=p>);</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>startTime</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>frameId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>null</span><span class=p>;</span>
<span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=nx>duration</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=o>,</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>html</span><span class=o>,</span>
<span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>welcome</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>opacity</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=kc>white</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>text-align</span><span class=p>:</span><span class=w> </span><span class=kc>center</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>background-image</span><span class=p>:</span><span class=w> </span><span class=nb>radial-gradient</span><span class=p>(</span>
<span class=w>        </span><span class=kc>circle</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>63</span><span class=p>,</span><span class=w> </span><span class=mi>94</span><span class=p>,</span><span class=w> </span><span class=mi>251</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>0</span><span class=kt>%</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>252</span><span class=p>,</span><span class=w> </span><span class=mi>70</span><span class=p>,</span><span class=w> </span><span class=mi>107</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Effects let you connect React to external systems. The more coordination between Effects is needed (for example, to chain multiple animations), the more it makes sense to extract that logic out of Effects and Hooks <em>completely</em> like in the sandbox above. Then, the code you extracted <em>becomes</em> the "external system". This lets your Effects stay simple because they only need to send messages to the system you've moved outside React.</p> <p>The examples above assume that the fade-in logic needs to be written in JavaScript. However, this particular fade-in animation is both simpler and much more efficient to implement with a plain <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Animations/Using_CSS_animations>CSS Animation:</a></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=p>,</span><span class=w> </span><span class=nx>useRef</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=s2>&quot;./welcome.css&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Welcome</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;welcome&quot;</span><span class=o>&gt;</span><span class=nx>Welcome</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>show</span><span class=p>,</span><span class=w> </span><span class=nx>setShow</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setShow</span><span class=p>(</span><span class=o>!</span><span class=nx>show</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Remove&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Show&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>show</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Welcome</span><span class=w> </span><span class=o>/&gt;</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>label</span><span class=o>,</span>
<span class=nt>button</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>display</span><span class=p>:</span><span class=w> </span><span class=kc>block</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>html</span><span class=o>,</span>
<span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>.</span><span class=nc>welcome</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=kc>white</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>text-align</span><span class=p>:</span><span class=w> </span><span class=kc>center</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>background-image</span><span class=p>:</span><span class=w> </span><span class=nb>radial-gradient</span><span class=p>(</span>
<span class=w>        </span><span class=kc>circle</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>63</span><span class=p>,</span><span class=w> </span><span class=mi>94</span><span class=p>,</span><span class=w> </span><span class=mi>251</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>0</span><span class=kt>%</span><span class=p>,</span>
<span class=w>        </span><span class=nb>rgba</span><span class=p>(</span><span class=mi>252</span><span class=p>,</span><span class=w> </span><span class=mi>70</span><span class=p>,</span><span class=w> </span><span class=mi>107</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span>
<span class=w>    </span><span class=p>);</span>

<span class=w>    </span><span class=k>animation</span><span class=p>:</span><span class=w> </span><span class=n>fadeIn</span><span class=w> </span><span class=mi>1000</span><span class=kt>ms</span><span class=p>;</span>
<span class=p>}</span>

<span class=p>@</span><span class=k>keyframes</span><span class=w> </span><span class=nt>fadeIn</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>0</span><span class=o>%</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>opacity</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nt>100</span><span class=o>%</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>opacity</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Sometimes, you don't even need a Hook!</p> <p><recap></p> <ul> <li>Custom Hooks let you share logic between components.</li> <li>Custom Hooks must be named starting with <code>use</code> followed by a capital letter.</li> <li>Custom Hooks only share stateful logic, not state itself.</li> <li>You can pass reactive values from one Hook to another, and they stay up-to-date.</li> <li>All Hooks re-run every time your component re-renders.</li> <li>The code of your custom Hooks should be pure, like your component's code.</li> <li>Wrap event handlers received by custom Hooks into Effect Events.</li> <li>Don't create custom Hooks like <code>useMount</code>. Keep their purpose specific.</li> <li>It's up to you how and where to choose the boundaries of your code.</li> </ul> <p></recap></p> <p><challenges></p> <h4 id=extract-a-usecounter-hook>Extract a <code>useCounter</code> Hook<a class=headerlink href=#extract-a-usecounter-hook title="Permanent link">&para;</a></h4> <p>This component uses a state variable and an Effect to display a number that increments every second. Extract this logic into a custom Hook called <code>useCounter</code>. Your goal is to make the <code>Counter</code> component implementation look exactly like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>You'll need to write your custom Hook in <code>useCounter.js</code> and import it into the <code>Counter.js</code> file.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span class=c1>// Write your custom Hook in this file!</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>Your code should look like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Notice that <code>App.js</code> doesn't need to import <code>useState</code> or <code>useEffect</code> anymore.</p> <p></solution></p> <h4 id=make-the-counter-delay-configurable>Make the counter delay configurable<a class=headerlink href=#make-the-counter-delay-configurable title="Permanent link">&para;</a></h4> <p>In this example, there is a <code>delay</code> state variable controlled by a slider, but its value is not used. Pass the <code>delay</code> value to your custom <code>useCounter</code> Hook, and change the <code>useCounter</code> Hook to use the passed <code>delay</code> instead of hardcoding <code>1000</code> ms.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>delay</span><span class=p>,</span><span class=w> </span><span class=nx>setDelay</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>1000</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Tick</span><span class=w> </span><span class=nx>duration</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>delay</span><span class=p>}</span><span class=w> </span><span class=nx>ms</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>br</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span>
<span class=w>                    </span><span class=nx>type</span><span class=o>=</span><span class=s2>&quot;range&quot;</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>delay</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>min</span><span class=o>=</span><span class=s2>&quot;10&quot;</span>
<span class=w>                    </span><span class=nx>max</span><span class=o>=</span><span class=s2>&quot;2000&quot;</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setDelay</span><span class=p>(</span><span class=nb>Number</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>))}</span>
<span class=w>                </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Ticks</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>Pass the <code>delay</code> to your Hook with <code>useCounter(delay)</code>. Then, inside the Hook, use <code>delay</code> instead of the hardcoded <code>1000</code> value. You'll need to add <code>delay</code> to your Effect's dependencies. This ensures that a change in <code>delay</code> will reset the interval.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>delay</span><span class=p>,</span><span class=w> </span><span class=nx>setDelay</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>1000</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>label</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Tick</span><span class=w> </span><span class=nx>duration</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>delay</span><span class=p>}</span><span class=w> </span><span class=nx>ms</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>br</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>input</span>
<span class=w>                    </span><span class=nx>type</span><span class=o>=</span><span class=s2>&quot;range&quot;</span>
<span class=w>                    </span><span class=nx>value</span><span class=o>=</span><span class=p>{</span><span class=nx>delay</span><span class=p>}</span>
<span class=w>                    </span><span class=nx>min</span><span class=o>=</span><span class=s2>&quot;10&quot;</span>
<span class=w>                    </span><span class=nx>max</span><span class=o>=</span><span class=s2>&quot;2000&quot;</span>
<span class=w>                    </span><span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setDelay</span><span class=p>(</span><span class=nb>Number</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>))}</span>
<span class=w>                </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/label&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>hr</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Ticks</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>delay</span><span class=p>]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p></solution></p> <h4 id=extract-useinterval-out-of-usecounter>Extract <code>useInterval</code> out of <code>useCounter</code><a class=headerlink href=#extract-useinterval-out-of-usecounter title="Permanent link">&para;</a></h4> <p>Currently, your <code>useCounter</code> Hook does two things. It sets up an interval, and it also increments a state variable on every interval tick. Split out the logic that sets up the interval into a separate Hook called <code>useInterval</code>. It should take two arguments: the <code>onTick</code> callback, and the <code>delay</code>. After this change, your <code>useCounter</code> implementation should look like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Write <code>useInterval</code> in the <code>useInterval.js</code> file and import it into the <code>useCounter.js</code> file.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=mf>1000</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>delay</span><span class=p>]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span class=c1>// Write your Hook here!</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>The logic inside <code>useInterval</code> should set up and clear the interval. It doesn't need to do anything else.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=mf>1000</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useInterval</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useInterval.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useInterval</span><span class=p>(</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Note that there is a bit of a problem with this solution, which you'll solve in the next challenge.</p> <p></solution></p> <h4 id=fix-a-resetting-interval>Fix a resetting interval<a class=headerlink href=#fix-a-resetting-interval title="Permanent link">&para;</a></h4> <p>In this example, there are <em>two</em> separate intervals.</p> <p>The <code>App</code> component calls <code>useCounter</code>, which calls <code>useInterval</code> to update the counter every second. But the <code>App</code> component <em>also</em> calls <code>useInterval</code> to randomly update the page background color every two seconds.</p> <p>For some reason, the callback that updates the page background never runs. Add some logs inside <code>useInterval</code>:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;✅ Setting up an interval with delay &quot;</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&quot;❌ Clearing an interval with delay &quot;</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>        </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>};</span>
<span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>]);</span>
</code></pre></div></td></tr></table></div> <p>Do the logs match what you expect to happen? If some of your Effects seem to re-synchronize unnecessarily, can you guess which dependency is causing that to happen? Is there some way to <a href=/learn/removing-effect-dependencies>remove that dependency</a> from your Effect?</p> <p>After you fix the issue, you should expect the page background to update every two seconds.</p> <p><hint></p> <p>It looks like your <code>useInterval</code> Hook accepts an event listener as an argument. Can you think of some way to wrap that event listener so that it doesn't need to be a dependency of your Effect?</p> <p></hint></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;react&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-dom&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;start&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts start&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;build&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts build&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;test&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts test --env=jsdom&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;eject&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts eject&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useInterval</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useInterval.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=mf>1000</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>randomColor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sb>`hsla(</span><span class=si>${</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>360</span><span class=si>}</span><span class=sb>, 100%, 50%, 0.2)`</span><span class=p>;</span>
<span class=w>        </span><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>backgroundColor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>randomColor</span><span class=p>;</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=mf>2000</span><span class=p>);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useInterval</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useInterval.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>experimental_useEffectEvent</span><span class=w> </span><span class=kr>as</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useInterval</span><span class=p>(</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>        </span><span class=p>};</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>Inside <code>useInterval</code>, wrap the tick callback into an Effect Event, as you did <a href=/learn/reusing-logic-with-custom-hooks#passing-event-handlers-to-custom-hooks>earlier on this page.</a></p> <p>This will allow you to omit <code>onTick</code> from dependencies of your Effect. The Effect won't re-synchronize on every re-render of the component, so the page background color change interval won't get reset every second before it has a chance to fire.</p> <p>With this change, both intervals work as expected and don't interfere with each other:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>    </span><span class=nt>&quot;dependencies&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;react&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-dom&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;experimental&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;react-scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;latest&quot;</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>&quot;scripts&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>&quot;start&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts start&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;build&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts build&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;test&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts test --env=jsdom&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nt>&quot;eject&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;react-scripts eject&quot;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useCounter</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useCounter.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useInterval</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useInterval.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Counter</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=mf>1000</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>randomColor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sb>`hsla(</span><span class=si>${</span><span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>360</span><span class=si>}</span><span class=sb>, 100%, 50%, 0.2)`</span><span class=p>;</span>
<span class=w>        </span><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>backgroundColor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>randomColor</span><span class=p>;</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=mf>2000</span><span class=p>);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Seconds</span><span class=w> </span><span class=nx>passed</span><span class=o>:</span><span class=w> </span><span class=p>{</span><span class=nx>count</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useInterval</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./useInterval.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useCounter</span><span class=p>(</span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>count</span><span class=p>,</span><span class=w> </span><span class=nx>setCount</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=mf>0</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setCount</span><span class=p>((</span><span class=nx>c</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>count</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>experimental_useEffectEvent</span><span class=w> </span><span class=kr>as</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>useInterval</span><span class=p>(</span><span class=nx>callback</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>onTick</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useEffectEvent</span><span class=p>(</span><span class=nx>callback</span><span class=p>);</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(</span><span class=nx>onTick</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>delay</span><span class=p>]);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p></solution></p> <h4 id=implement-a-staggering-movement>Implement a staggering movement<a class=headerlink href=#implement-a-staggering-movement title="Permanent link">&para;</a></h4> <p>In this example, the <code>usePointerPosition()</code> Hook tracks the current pointer position. Try moving your cursor or your finger over the preview area and see the red dot follow your movement. Its position is saved in the <code>pos1</code> variable.</p> <p>In fact, there are five (!) different red dots being rendered. You don't see them because currently they all appear at the same position. This is what you need to fix. What you want to implement instead is a "staggered" movement: each dot should "follow" the previous dot's path. For example, if you quickly move your cursor, the first dot should follow it immediately, the second dot should follow the first dot with a small delay, the third dot should follow the second dot, and so on.</p> <p>You need to implement the <code>useDelayedValue</code> custom Hook. Its current implementation returns the <code>value</code> provided to it. Instead, you want to return the value back from <code>delay</code> milliseconds ago. You might need some state and an Effect to do this.</p> <p>After you implement <code>useDelayedValue</code>, you should see the dots move following one another.</p> <p><hint></p> <p>You'll need to store the <code>delayedValue</code> as a state variable inside your custom Hook. When the <code>value</code> changes, you'll want to run an Effect. This Effect should update <code>delayedValue</code> after the <code>delay</code>. You might find it helpful to call <code>setTimeout</code>.</p> <p>Does this Effect need cleanup? Why or why not?</p> <p></hint></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>usePointerPosition</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./usePointerPosition.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// TODO: Implement this Hook</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>value</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Canvas</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>usePointerPosition</span><span class=p>();</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos1</span><span class=p>,</span><span class=w> </span><span class=mf>100</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos2</span><span class=p>,</span><span class=w> </span><span class=mf>200</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos3</span><span class=p>,</span><span class=w> </span><span class=mf>100</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos5</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos3</span><span class=p>,</span><span class=w> </span><span class=mf>50</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos1</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>1</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos2</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.8</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos3</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.6</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos4</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.4</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos5</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.2</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Dot</span><span class=p>({</span><span class=w> </span><span class=nx>position</span><span class=p>,</span><span class=w> </span><span class=nx>opacity</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>div</span>
<span class=w>            </span><span class=nx>style</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                </span><span class=nx>position</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;absolute&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>backgroundColor</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;pink&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>borderRadius</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;50%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>opacity</span><span class=p>,</span>
<span class=w>                </span><span class=nx>transform</span><span class=o>:</span><span class=w> </span><span class=sb>`translate(</span><span class=si>${</span><span class=nx>position</span><span class=p>.</span><span class=nx>x</span><span class=si>}</span><span class=sb>px, </span><span class=si>${</span><span class=nx>position</span><span class=p>.</span><span class=nx>y</span><span class=si>}</span><span class=sb>px)`</span><span class=p>,</span>
<span class=w>                </span><span class=nx>pointerEvents</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;none&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>left</span><span class=o>:</span><span class=w> </span><span class=o>-</span><span class=mf>20</span><span class=p>,</span>
<span class=w>                </span><span class=nx>top</span><span class=o>:</span><span class=w> </span><span class=o>-</span><span class=mf>20</span><span class=p>,</span>
<span class=w>                </span><span class=nx>width</span><span class=o>:</span><span class=w> </span><span class=mf>40</span><span class=p>,</span>
<span class=w>                </span><span class=nx>height</span><span class=o>:</span><span class=w> </span><span class=mf>40</span><span class=p>,</span>
<span class=w>            </span><span class=p>}}</span>
<span class=w>        </span><span class=o>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>usePointerPosition</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>position</span><span class=p>,</span><span class=w> </span><span class=nx>setPosition</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>({</span><span class=w> </span><span class=nx>x</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=p>,</span><span class=w> </span><span class=nx>y</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleMove</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setPosition</span><span class=p>({</span><span class=w> </span><span class=nx>x</span><span class=o>:</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>clientX</span><span class=p>,</span><span class=w> </span><span class=nx>y</span><span class=o>:</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>clientY</span><span class=w> </span><span class=p>});</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;pointermove&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleMove</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;pointermove&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleMove</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>position</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>Here is a working version. You keep the <code>delayedValue</code> as a state variable. When <code>value</code> updates, your Effect schedules a timeout to update the <code>delayedValue</code>. This is why the <code>delayedValue</code> always "lags behind" the actual <code>value</code>.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>usePointerPosition</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./usePointerPosition.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>value</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>delayedValue</span><span class=p>,</span><span class=w> </span><span class=nx>setDelayedValue</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>

<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setDelayedValue</span><span class=p>(</span><span class=nx>value</span><span class=p>);</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=nx>delay</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[</span><span class=nx>value</span><span class=p>,</span><span class=w> </span><span class=nx>delay</span><span class=p>]);</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>delayedValue</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Canvas</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>usePointerPosition</span><span class=p>();</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos1</span><span class=p>,</span><span class=w> </span><span class=mf>100</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos2</span><span class=p>,</span><span class=w> </span><span class=mf>200</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos3</span><span class=p>,</span><span class=w> </span><span class=mf>100</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>pos5</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useDelayedValue</span><span class=p>(</span><span class=nx>pos3</span><span class=p>,</span><span class=w> </span><span class=mf>50</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos1</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>1</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos2</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.8</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos3</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.6</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos4</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.4</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Dot</span><span class=w> </span><span class=nx>position</span><span class=o>=</span><span class=p>{</span><span class=nx>pos5</span><span class=p>}</span><span class=w> </span><span class=nx>opacity</span><span class=o>=</span><span class=p>{</span><span class=mf>0.2</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Dot</span><span class=p>({</span><span class=w> </span><span class=nx>position</span><span class=p>,</span><span class=w> </span><span class=nx>opacity</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>div</span>
<span class=w>            </span><span class=nx>style</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                </span><span class=nx>position</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;absolute&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>backgroundColor</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;pink&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>borderRadius</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;50%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>opacity</span><span class=p>,</span>
<span class=w>                </span><span class=nx>transform</span><span class=o>:</span><span class=w> </span><span class=sb>`translate(</span><span class=si>${</span><span class=nx>position</span><span class=p>.</span><span class=nx>x</span><span class=si>}</span><span class=sb>px, </span><span class=si>${</span><span class=nx>position</span><span class=p>.</span><span class=nx>y</span><span class=si>}</span><span class=sb>px)`</span><span class=p>,</span>
<span class=w>                </span><span class=nx>pointerEvents</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;none&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>left</span><span class=o>:</span><span class=w> </span><span class=o>-</span><span class=mf>20</span><span class=p>,</span>
<span class=w>                </span><span class=nx>top</span><span class=o>:</span><span class=w> </span><span class=o>-</span><span class=mf>20</span><span class=p>,</span>
<span class=w>                </span><span class=nx>width</span><span class=o>:</span><span class=w> </span><span class=mf>40</span><span class=p>,</span>
<span class=w>                </span><span class=nx>height</span><span class=o>:</span><span class=w> </span><span class=mf>40</span><span class=p>,</span>
<span class=w>            </span><span class=p>}}</span>
<span class=w>        </span><span class=o>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>usePointerPosition</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>position</span><span class=p>,</span><span class=w> </span><span class=nx>setPosition</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>({</span><span class=w> </span><span class=nx>x</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=p>,</span><span class=w> </span><span class=nx>y</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=w> </span><span class=p>});</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>function</span><span class=w> </span><span class=nx>handleMove</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setPosition</span><span class=p>({</span><span class=w> </span><span class=nx>x</span><span class=o>:</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>clientX</span><span class=p>,</span><span class=w> </span><span class=nx>y</span><span class=o>:</span><span class=w> </span><span class=nx>e</span><span class=p>.</span><span class=nx>clientY</span><span class=w> </span><span class=p>});</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&quot;pointermove&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleMove</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nb>window</span><span class=p>.</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s2>&quot;pointermove&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>handleMove</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>position</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>body</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>min-height</span><span class=p>:</span><span class=w> </span><span class=mi>300</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Note that this Effect <em>does not</em> need cleanup. If you called <code>clearTimeout</code> in the cleanup function, then each time the <code>value</code> changes, it would reset the already scheduled timeout. To keep the movement continuous, you want all the timeouts to fire.</p> <p></solution></p> <p></challenges></p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 28, 2023 08:11:22">August 28, 2023</span> </small> </div> <div class=md-source-date> <small> Authors: <span class="git-page-authors git-authors"><a href=mailto:16909269+archmonger@users.noreply.github.com>Archmonger</a></span> </small> </div> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy;<div id=year> </div> <script> document.getElementById("year").innerHTML = new Date().getFullYear(); </script>Reactive Python and affiliates.<div class=legal-footer-right>This project has no affiliation to ReactJS or Meta Platforms, Inc.</div> </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "content.code.copy", "search.highlight"], "search": "../../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.4e0fa4ba.min.js></script> <script src=../../assets/js/main.js></script> </body> </html>