<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="It's React, but in Python."><meta name=author content=Archmonger><link href=https://reactive-python.github.io/reactpy/learn/keeping-components-pure/ rel=canonical><link href=../rendering-lists/ rel=prev><link href=../responding-to-events/ rel=next><link rel=icon href=https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.4.0"><title>Keeping Components Pure ðŸš§ - ReactPy</title><link rel=stylesheet href=../../assets/stylesheets/main.9f615399.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.649f08f9.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64H64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64 32-32z"/></svg>');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../assets/css/main.css><link rel=stylesheet href=../../assets/css/button.css><link rel=stylesheet href=../../assets/css/admonition.css><link rel=stylesheet href=../../assets/css/banner.css><link rel=stylesheet href=../../assets/css/sidebar.css><link rel=stylesheet href=../../assets/css/navbar.css><link rel=stylesheet href=../../assets/css/table-of-contents.css><link rel=stylesheet href=../../assets/css/code.css><link rel=stylesheet href=../../assets/css/footer.css><link rel=stylesheet href=../../assets/css/home.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest release. <a href=../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=ReactPy class="md-header__button md-logo" aria-label=ReactPy data-md-component=logo> <img src=https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ReactPy </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Keeping Components Pure ðŸš§ </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81 1.42-1.42M1 13h3v-2H1m12 9h-2v3h2"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/reactive-python/reactpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> ReactPy </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../quick-start/ class=md-tabs__link> Get Started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../your-first-component/ class=md-tabs__link> Learn </a> </li> <li class=md-tabs__item> <a href=../../reference/overview/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../about/changelog/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=ReactPy class="md-nav__button md-logo" aria-label=ReactPy data-md-component=logo> <img src=https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg alt=logo> </a> ReactPy </label> <div class=md-nav__source> <a href=https://github.com/reactive-python/reactpy title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> ReactPy </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Get Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Get Started </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Quick Start </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Quick Start </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick start </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-tic-tac-toe/ class=md-nav__link> <span class=md-ellipsis> Tutorial: Tic-Tac-Toe ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../thinking-in-react/ class=md-nav__link> <span class=md-ellipsis> Thinking in React </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Installation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../creating-a-react-app/ class=md-nav__link> <span class=md-ellipsis> Creating a Standalone React App </span> </a> </li> <li class=md-nav__item> <a href=../add-react-to-an-existing-project/ class=md-nav__link> <span class=md-ellipsis> Add React to an Existing Project </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../editor-setup/ class=md-nav__link> <span class=md-ellipsis> Editor Setup </span> </a> </li> <li class=md-nav__item> <a href=../tools-and-packages/ class=md-nav__link> <span class=md-ellipsis> Tools, Libraries, and Packages </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Learn </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> Describing the UI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Describing the UI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../your-first-component/ class=md-nav__link> <span class=md-ellipsis> Your First Component ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../importing-and-exporting-components/ class=md-nav__link> <span class=md-ellipsis> Importing and Exporting Components ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../passing-props-to-a-component/ class=md-nav__link> <span class=md-ellipsis> Passing Props to a Component ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../conditional-rendering/ class=md-nav__link> <span class=md-ellipsis> Conditional Rendering ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../rendering-lists/ class=md-nav__link> <span class=md-ellipsis> Rendering Lists ðŸš§ </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Keeping Components Pure ðŸš§ </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Keeping Components Pure ðŸš§ </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#purity-components-as-formulas class=md-nav__link> Purity: Components as formulas </a> </li> <li class=md-nav__item> <a href=#side-effects-unintended-consequences class=md-nav__link> Side Effects: (un)intended consequences </a> <nav class=md-nav aria-label="Side Effects: (un)intended consequences"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#detecting-impure-calculations-with-strictmode class=md-nav__link> Detecting impure calculations with StrictMode </a> </li> <li class=md-nav__item> <a href=#local-mutation-your-components-little-secret class=md-nav__link> Local mutation: Your component's little secret </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#where-you-can-cause-side-effects class=md-nav__link> Where you can cause side effects </a> <nav class=md-nav aria-label="Where you can cause side effects"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-does-react-care-about-purity class=md-nav__link> Why does React care about purity? </a> </li> <li class=md-nav__item> <a href=#fix-a-broken-clock class=md-nav__link> Fix a broken clock </a> </li> <li class=md-nav__item> <a href=#fix-a-broken-profile class=md-nav__link> Fix a broken profile </a> </li> <li class=md-nav__item> <a href=#fix-a-broken-story-tray class=md-nav__link> Fix a broken story tray </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Adding Interactivity </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Adding Interactivity </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../responding-to-events/ class=md-nav__link> <span class=md-ellipsis> Responding to Events ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../state-a-components-memory/ class=md-nav__link> <span class=md-ellipsis> State: A Component's Memory ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../render-and-commit/ class=md-nav__link> <span class=md-ellipsis> Render and Commit ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../state-as-a-snapshot/ class=md-nav__link> <span class=md-ellipsis> State as a Snapshot ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../queueing-a-series-of-state-updates/ class=md-nav__link> <span class=md-ellipsis> Queueing a Series of State Updates ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../updating-objects-in-state/ class=md-nav__link> <span class=md-ellipsis> Updating Objects in State ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../updating-arrays-in-state/ class=md-nav__link> <span class=md-ellipsis> Updating Arrays in State ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Managing State </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Managing State </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../reacting-to-input-with-state/ class=md-nav__link> <span class=md-ellipsis> Reacting to Input with State ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../choosing-the-state-structure/ class=md-nav__link> <span class=md-ellipsis> Choosing the State Structure ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../sharing-state-between-components/ class=md-nav__link> <span class=md-ellipsis> Sharing State Between Components ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../preserving-and-resetting-state/ class=md-nav__link> <span class=md-ellipsis> Preserving and Resetting State ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../extracting-state-logic-into-a-reducer/ class=md-nav__link> <span class=md-ellipsis> Extracting State Logic into a Reducer ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../passing-data-deeply-with-context/ class=md-nav__link> <span class=md-ellipsis> Passing Data Deeply with Context ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../scaling-up-with-reducer-and-context/ class=md-nav__link> <span class=md-ellipsis> Scaling Up with Reducer and Context ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Escape Hatches </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Escape Hatches </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../referencing-values-with-refs/ class=md-nav__link> <span class=md-ellipsis> Referencing Values with Refs ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../manipulating-the-dom-with-refs/ class=md-nav__link> <span class=md-ellipsis> Manipulating the DOM with Refs ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../synchronizing-with-effects/ class=md-nav__link> <span class=md-ellipsis> Synchronizing with Effects ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../you-might-not-need-an-effect/ class=md-nav__link> <span class=md-ellipsis> You Might Not Need an Effect ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../lifecycle-of-reactive-effects/ class=md-nav__link> <span class=md-ellipsis> Lifecycle of Reactive Effects ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../separating-events-from-effects/ class=md-nav__link> <span class=md-ellipsis> Separating Events from Effects ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../removing-effect-dependencies/ class=md-nav__link> <span class=md-ellipsis> Removing Effect Dependencies ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../reusing-logic-with-custom-hooks/ class=md-nav__link> <span class=md-ellipsis> Reusing Logic with Custom Hooks ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../communicate-data-between-server-and-client/ class=md-nav__link> <span class=md-ellipsis> Communicating Data Between Server and Client ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../convert-between-vdom-and-html/ class=md-nav__link> <span class=md-ellipsis> Convert Between VDOM and HTML ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../vdom-mutations/ class=md-nav__link> <span class=md-ellipsis> VDOM Mutations ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../creating-vdom-event-handlers/ class=md-nav__link> <span class=md-ellipsis> Creating VDOM Event Handlers ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../creating-html-tags/ class=md-nav__link> <span class=md-ellipsis> Creating HTML Tags ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../creating-backends/ class=md-nav__link> <span class=md-ellipsis> Creating Backends ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../manually-register-a-client/ class=md-nav__link> <span class=md-ellipsis> Manually Register a Client ðŸš§ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class=md-ellipsis> Hooks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Hooks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/use-state/ class=md-nav__link> <span class=md-ellipsis> Use State ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-effect/ class=md-nav__link> <span class=md-ellipsis> Use Effect ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-async-effect/ class=md-nav__link> <span class=md-ellipsis> Use Async Effect ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-context/ class=md-nav__link> <span class=md-ellipsis> Use Context ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-reducer/ class=md-nav__link> <span class=md-ellipsis> Use Reducer ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-callback/ class=md-nav__link> <span class=md-ellipsis> Use Callback ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-memo/ class=md-nav__link> <span class=md-ellipsis> Use Memo ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-ref/ class=md-nav__link> <span class=md-ellipsis> Use Ref ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-debug-value/ class=md-nav__link> <span class=md-ellipsis> Use Debug Value ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-connection/ class=md-nav__link> <span class=md-ellipsis> Use Connection ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-scope/ class=md-nav__link> <span class=md-ellipsis> Use Scope ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/use-location/ class=md-nav__link> <span class=md-ellipsis> Use Location ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class=md-ellipsis> HTML Tags </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> HTML Tags </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/common-props/ class=md-nav__link> <span class=md-ellipsis> Common Props ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/usage/ class=md-nav__link> <span class=md-ellipsis> Usage ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex=0> <span class=md-ellipsis> Executors </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Executors </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/reactpy/ class=md-nav__link> <span class=md-ellipsis> ReactPy </span> </a> </li> <li class=md-nav__item> <a href=../../reference/reactpy-csr/ class=md-nav__link> <span class=md-ellipsis> ReactPyCsr ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/reactpy-middleware/ class=md-nav__link> <span class=md-ellipsis> ReactPyMiddleware ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex=0> <span class=md-ellipsis> Rules of React </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Rules of React </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/rules-of-react/ class=md-nav__link> <span class=md-ellipsis> Overview ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/components-and-hooks-must-be-pure/ class=md-nav__link> <span class=md-ellipsis> Components and Hooks must be pure ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/react-calls-components-and-hooks/ class=md-nav__link> <span class=md-ellipsis> React calls Components and Hooks ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/rules-of-hooks/ class=md-nav__link> <span class=md-ellipsis> Rules of Hooks ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex=0> <span class=md-ellipsis> Template Tags </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Template Tags </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/jinja/ class=md-nav__link> <span class=md-ellipsis> Jinja ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../reference/protocol-structure/ class=md-nav__link> <span class=md-ellipsis> Protocol Structure ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../reference/client-api/ class=md-nav__link> <span class=md-ellipsis> Client API ðŸš§ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../about/community/ class=md-nav__link> <span class=md-ellipsis> Community ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../about/running-tests/ class=md-nav__link> <span class=md-ellipsis> Running Tests ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../about/code/ class=md-nav__link> <span class=md-ellipsis> Contributing Code ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../about/docs/ class=md-nav__link> <span class=md-ellipsis> Contributing Documentation ðŸš§ </span> </a> </li> <li class=md-nav__item> <a href=../../about/licenses/ class=md-nav__link> <span class=md-ellipsis> Licenses ðŸš§ </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=#purity-components-as-formulas class=md-nav__link> Purity: Components as formulas </a> </li> <li class=md-nav__item> <a href=#side-effects-unintended-consequences class=md-nav__link> Side Effects: (un)intended consequences </a> <nav class=md-nav aria-label="Side Effects: (un)intended consequences"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#detecting-impure-calculations-with-strictmode class=md-nav__link> Detecting impure calculations with StrictMode </a> </li> <li class=md-nav__item> <a href=#local-mutation-your-components-little-secret class=md-nav__link> Local mutation: Your component's little secret </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#where-you-can-cause-side-effects class=md-nav__link> Where you can cause side effects </a> <nav class=md-nav aria-label="Where you can cause side effects"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-does-react-care-about-purity class=md-nav__link> Why does React care about purity? </a> </li> <li class=md-nav__item> <a href=#fix-a-broken-clock class=md-nav__link> Fix a broken clock </a> </li> <li class=md-nav__item> <a href=#fix-a-broken-profile class=md-nav__link> Fix a broken profile </a> </li> <li class=md-nav__item> <a href=#fix-a-broken-story-tray class=md-nav__link> Fix a broken story tray </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Keeping Components Pure ðŸš§</h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p class=intro> Some JavaScript functions are <em>pure.</em> Pure functions only perform a calculation and nothing more. By strictly only writing your components as pure functions, you can avoid an entire class of baffling bugs and unpredictable behavior as your codebase grows. To get these benefits, though, there are a few rules you must follow. </p> <div class="admonition summary"> <p class=admonition-title>You will learn</p> <ul> <li>What purity is and how it helps you avoid bugs</li> <li>How to keep components pure by keeping changes out of the render phase</li> <li>How to use Strict Mode to find mistakes in your components</li> </ul> </div> <h2 id=purity-components-as-formulas>Purity: Components as formulas<a class=headerlink href=#purity-components-as-formulas title="Permanent link">&para;</a></h2> <p>In computer science (and especially the world of functional programming), <a href=https://wikipedia.org/wiki/Pure_function>a pure function</a> is a function with the following characteristics:</p> <ul> <li><strong>It minds its own business.</strong> It does not change any objects or variables that existed before it was called.</li> <li><strong>Same inputs, same output.</strong> Given the same inputs, a pure function should always return the same result.</li> </ul> <p>You might already be familiar with one example of pure functions: formulas in math.</p> <p>Consider this math formula: <math><mathi>y</mathi> = 2<mathi>x</mathi></math>.</p> <p>If <math><mathi>x</mathi> = 2</math> then <math><mathi>y</mathi> = 4</math>. Always.</p> <p>If <math><mathi>x</mathi> = 3</math> then <math><mathi>y</mathi> = 6</math>. Always.</p> <p>If <math><mathi>x</mathi> = 3</math>, <mathi>y</mathi> won't sometimes be <math>9</math> or <math>â€“1</math> or <math>2.5</math> depending on the time of day or the state of the stock market.</p> <p>If <math><mathi>y</mathi> = 2<mathi>x</mathi></math> and <math><mathi>x</mathi> = 3</math>, <mathi>y</mathi> will <em>always</em> be <math>6</math>.</p> <p>If we made this into a JavaScript function, it would look like this:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=kr>double</span><span class=p>(</span><span class=nx>number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mf>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>number</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>In the above example, <code>double</code> is a <strong>pure function.</strong> If you pass it <code>3</code>, it will return <code>6</code>. Always.</p> <p>React is designed around this concept. <strong>React assumes that every component you write is a pure function.</strong> This means that React components you write must always return the same JSX given the same inputs:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>Recipe</span><span class=p>({</span><span class=w> </span><span class=nx>drinkers</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>ol</span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span><span class=nx>Boil</span><span class=w> </span><span class=p>{</span><span class=nx>drinkers</span><span class=p>}</span><span class=w> </span><span class=nx>cups</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=nx>water</span><span class=p>.</span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Add</span><span class=w> </span><span class=p>{</span><span class=nx>drinkers</span><span class=p>}</span><span class=w> </span><span class=nx>spoons</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=nx>tea</span><span class=w> </span><span class=nx>and</span><span class=w> </span><span class=p>{</span><span class=mf>0.5</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>drinkers</span><span class=p>}</span><span class=w> </span><span class=nx>spoons</span><span class=w> </span><span class=k>of</span>
<span class=w>                </span><span class=nx>spice</span><span class=p>.</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span>
<span class=w>                </span><span class=nx>Add</span><span class=w> </span><span class=p>{</span><span class=mf>0.5</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=nx>drinkers</span><span class=p>}</span><span class=w> </span><span class=nx>cups</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=nx>milk</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>boil</span><span class=w> </span><span class=nx>and</span><span class=w> </span><span class=nx>sugar</span><span class=w> </span><span class=nx>to</span><span class=w> </span><span class=nx>taste</span><span class=p>.</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/ol&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>section</span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=nx>Spiced</span><span class=w> </span><span class=nx>Chai</span><span class=w> </span><span class=nx>Recipe</span><span class=o>&lt;</span><span class=err>/h1&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>For</span><span class=w> </span><span class=nx>two</span><span class=o>&lt;</span><span class=err>/h2&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Recipe</span><span class=w> </span><span class=nx>drinkers</span><span class=o>=</span><span class=p>{</span><span class=mf>2</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>For</span><span class=w> </span><span class=nx>a</span><span class=w> </span><span class=nx>gathering</span><span class=o>&lt;</span><span class=err>/h2&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Recipe</span><span class=w> </span><span class=nx>drinkers</span><span class=o>=</span><span class=p>{</span><span class=mf>4</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/section&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>When you pass <code>drinkers={2}</code> to <code>Recipe</code>, it will return JSX containing <code>2 cups of water</code>. Always.</p> <p>If you pass <code>drinkers={4}</code>, it will return JSX containing <code>4 cups of water</code>. Always.</p> <p>Just like a math formula.</p> <p>You could think of your components as recipes: if you follow them and don't introduce new ingredients during the cooking process, you will get the same dish every time. That "dish" is the JSX that the component serves to React to <a href=/learn/render-and-commit>render.</a></p> <p><illustration src=/images/docs/illustrations/i_puritea-recipe.png alt="A tea recipe for x people: take x cups of water, add x spoons of tea and 0.5x spoons of spices, and 0.5x cups of milk"/></p> <h2 id=side-effects-unintended-consequences>Side Effects: (un)intended consequences<a class=headerlink href=#side-effects-unintended-consequences title="Permanent link">&para;</a></h2> <p>React's rendering process must always be pure. Components should only <em>return</em> their JSX, and not <em>change</em> any objects or variables that existed before renderingâ€”that would make them impure!</p> <p>Here is a component that breaks this rule:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>let</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Cup</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Bad: changing a preexisting variable!</span>
<span class=w>    </span><span class=nx>guest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>1</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>Tea</span><span class=w> </span><span class=nx>cup</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=nx>guest</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h2&gt;;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>TeaSet</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This component is reading and writing a <code>guest</code> variable declared outside of it. This means that <strong>calling this component multiple times will produce different JSX!</strong> And what's more, if <em>other</em> components read <code>guest</code>, they will produce different JSX, too, depending on when they were rendered! That's not predictable.</p> <p>Going back to our formula <math><mathi>y</mathi> = 2<mathi>x</mathi></math>, now even if <math><mathi>x</mathi> = 2</math>, we cannot trust that <math><mathi>y</mathi> = 4</math>. Our tests could fail, our users would be baffled, planes would fall out of the skyâ€”you can see how this would lead to confusing bugs!</p> <p>You can fix this component by <a href=/learn/passing-props-to-a-component>passing <code>guest</code> as a prop instead</a>:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>Cup</span><span class=p>({</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>Tea</span><span class=w> </span><span class=nx>cup</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=nx>guest</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h2&gt;;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>TeaSet</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=nx>guest</span><span class=o>=</span><span class=p>{</span><span class=mf>1</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=nx>guest</span><span class=o>=</span><span class=p>{</span><span class=mf>2</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=nx>guest</span><span class=o>=</span><span class=p>{</span><span class=mf>3</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Now your component is pure, as the JSX it returns only depends on the <code>guest</code> prop.</p> <p>In general, you should not expect your components to be rendered in any particular order. It doesn't matter if you call <math><mathi>y</mathi> = 2<mathi>x</mathi></math> before or after <math><mathi>y</mathi> = 5<mathi>x</mathi></math>: both formulas will resolve independently of each other. In the same way, each component should only "think for itself", and not attempt to coordinate with or depend upon others during rendering. Rendering is like a school exam: each component should calculate JSX on their own!</p> <p><deepdive></p> <h4 id=detecting-impure-calculations-with-strictmode>Detecting impure calculations with StrictMode<a class=headerlink href=#detecting-impure-calculations-with-strictmode title="Permanent link">&para;</a></h4> <p>Although you might not have used them all yet, in React there are three kinds of inputs that you can read while rendering: <a href=/learn/passing-props-to-a-component>props</a>, <a href=/learn/state-a-components-memory>state</a>, and <a href=/learn/passing-data-deeply-with-context>context.</a> You should always treat these inputs as read-only.</p> <p>When you want to <em>change</em> something in response to user input, you should <a href=/learn/state-a-components-memory>set state</a> instead of writing to a variable. You should never change preexisting variables or objects while your component is rendering.</p> <p>React offers a "Strict Mode" in which it calls each component's function twice during development. <strong>By calling the component functions twice, Strict Mode helps find components that break these rules.</strong></p> <p>Notice how the original example displayed "Guest #2", "Guest #4", and "Guest #6" instead of "Guest #1", "Guest #2", and "Guest #3". The original function was impure, so calling it twice broke it. But the fixed pure version works even if the function is called twice every time. <strong>Pure functions only calculate, so calling them twice won't change anything</strong>--just like calling <code>double(2)</code> twice doesn't change what's returned, and solving <math><mathi>y</mathi> = 2<mathi>x</mathi></math> twice doesn't change what <mathi>y</mathi> is. Same inputs, same outputs. Always.</p> <p>Strict Mode has no effect in production, so it won't slow down the app for your users. To opt into Strict Mode, you can wrap your root component into <code>&lt;React.StrictMode&gt;</code>. Some frameworks do this by default.</p> <p></deepdive></p> <h3 id=local-mutation-your-components-little-secret>Local mutation: Your component's little secret<a class=headerlink href=#local-mutation-your-components-little-secret title="Permanent link">&para;</a></h3> <p>In the above example, the problem was that the component changed a <em>preexisting</em> variable while rendering. This is often called a <strong>"mutation"</strong> to make it sound a bit scarier. Pure functions don't mutate variables outside of the function's scope or objects that were created before the callâ€”that makes them impure!</p> <p>However, <strong>it's completely fine to change variables and objects that you've <em>just</em> created while rendering.</strong> In this example, you create an <code>[]</code> array, assign it to a <code>cups</code> variable, and then <code>push</code> a dozen cups into it:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span class=kd>function</span><span class=w> </span><span class=nx>Cup</span><span class=p>({</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>Tea</span><span class=w> </span><span class=nx>cup</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=nx>guest</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=nx>guest</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h2&gt;;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>TeaGathering</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>cups</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[];</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kd>let</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mf>12</span><span class=p>;</span><span class=w> </span><span class=nx>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>cups</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=o>&lt;</span><span class=nx>Cup</span><span class=w> </span><span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>i</span><span class=p>}</span><span class=w> </span><span class=nx>guest</span><span class=o>=</span><span class=p>{</span><span class=nx>i</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>cups</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>If the <code>cups</code> variable or the <code>[]</code> array were created outside the <code>TeaGathering</code> function, this would be a huge problem! You would be changing a <em>preexisting</em> object by pushing items into that array.</p> <p>However, it's fine because you've created them <em>during the same render</em>, inside <code>TeaGathering</code>. No code outside of <code>TeaGathering</code> will ever know that this happened. This is called <strong>"local mutation"</strong>â€”it's like your component's little secret.</p> <h2 id=where-you-can-cause-side-effects>Where you <em>can</em> cause side effects<a class=headerlink href=#where-you-can-cause-side-effects title="Permanent link">&para;</a></h2> <p>While functional programming relies heavily on purity, at some point, somewhere, <em>something</em> has to change. That's kind of the point of programming! These changesâ€”updating the screen, starting an animation, changing the dataâ€”are called <strong>side effects.</strong> They're things that happen <em>"on the side"</em>, not during rendering.</p> <p>In React, <strong>side effects usually belong inside <a href=/learn/responding-to-events>event handlers.</a></strong> Event handlers are functions that React runs when you perform some actionâ€”for example, when you click a button. Even though event handlers are defined <em>inside</em> your component, they don't run <em>during</em> rendering! <strong>So event handlers don't need to be pure.</strong></p> <p>If you've exhausted all other options and can't find the right event handler for your side effect, you can still attach it to your returned JSX with a <a href=/reference/react/useEffect><code>useEffect</code></a> call in your component. This tells React to execute it later, after rendering, when side effects are allowed. <strong>However, this approach should be your last resort.</strong></p> <p>When possible, try to express your logic with rendering alone. You'll be surprised how far this can take you!</p> <p><deepdive></p> <h4 id=why-does-react-care-about-purity>Why does React care about purity?<a class=headerlink href=#why-does-react-care-about-purity title="Permanent link">&para;</a></h4> <p>Writing pure functions takes some habit and discipline. But it also unlocks marvelous opportunities:</p> <ul> <li>Your components could run in a different environmentâ€”for example, on the server! Since they return the same result for the same inputs, one component can serve many user requests.</li> <li>You can improve performance by <a href=/reference/react/memo>skipping rendering</a> components whose inputs have not changed. This is safe because pure functions always return the same results, so they are safe to cache.</li> <li>If some data changes in the middle of rendering a deep component tree, React can restart rendering without wasting time to finish the outdated render. Purity makes it safe to stop calculating at any time.</li> </ul> <p>Every new React feature we're building takes advantage of purity. From data fetching to animations to performance, keeping components pure unlocks the power of the React paradigm.</p> <p></deepdive></p> <p><recap></p> <ul> <li>A component must be pure, meaning:<ul> <li><strong>It minds its own business.</strong> It should not change any objects or variables that existed before rendering.</li> <li><strong>Same inputs, same output.</strong> Given the same inputs, a component should always return the same JSX.</li> </ul> </li> <li>Rendering can happen at any time, so components should not depend on each others' rendering sequence.</li> <li>You should not mutate any of the inputs that your components use for rendering. That includes props, state, and context. To update the screen, <a href=/learn/state-a-components-memory>"set" state</a> instead of mutating preexisting objects.</li> <li>Strive to express your component's logic in the JSX you return. When you need to "change things", you'll usually want to do it in an event handler. As a last resort, you can <code>useEffect</code>.</li> <li>Writing pure functions takes a bit of practice, but it unlocks the power of React's paradigm.</li> </ul> <p></recap></p> <p><challenges></p> <h4 id=fix-a-broken-clock>Fix a broken clock<a class=headerlink href=#fix-a-broken-clock title="Permanent link">&para;</a></h4> <p>This component tries to set the <code>&lt;h1&gt;</code>'s CSS class to <code>"night"</code> during the time from midnight to six hours in the morning, and <code>"day"</code> at all other times. However, it doesn't work. Can you fix this component?</p> <p>You can verify whether your solution works by temporarily changing the computer's timezone. When the current time is between midnight and six in the morning, the clock should have inverted colors!</p> <p><hint></p> <p>Rendering is a <em>calculation</em>, it shouldn't try to "do" things. Can you express the same idea differently?</p> <p></hint></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Clock</span><span class=p>({</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>hours</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>getHours</span><span class=p>();</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>hours</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mf>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nx>hours</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mf>6</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;time&quot;</span><span class=p>).</span><span class=nx>className</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;night&quot;</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;time&quot;</span><span class=p>).</span><span class=nx>className</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;day&quot;</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>id</span><span class=o>=</span><span class=s2>&quot;time&quot;</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>toLocaleTimeString</span><span class=p>()}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>Clock</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./Clock.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useTime</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>time</span><span class=p>,</span><span class=w> </span><span class=nx>setTime</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setTime</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>time</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useTime</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Clock</span><span class=w> </span><span class=nx>time</span><span class=o>=</span><span class=p>{</span><span class=nx>time</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>body</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
<span class=w>    </span><span class=k>height</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>day</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>background</span><span class=p>:</span><span class=w> </span><span class=mh>#fff</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=mh>#222</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>night</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>background</span><span class=p>:</span><span class=w> </span><span class=mh>#222</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=mh>#fff</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>You can fix this component by calculating the <code>className</code> and including it in the render output:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Clock</span><span class=p>({</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>hours</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>getHours</span><span class=p>();</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>className</span><span class=p>;</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>hours</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mf>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nx>hours</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mf>6</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>className</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;night&quot;</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>className</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;day&quot;</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=p>{</span><span class=nx>className</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>toLocaleTimeString</span><span class=p>()}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>Clock</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./Clock.js&quot;</span><span class=p>;</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useTime</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>time</span><span class=p>,</span><span class=w> </span><span class=nx>setTime</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setTime</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>time</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useTime</span><span class=p>();</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>Clock</span><span class=w> </span><span class=nx>time</span><span class=o>=</span><span class=p>{</span><span class=nx>time</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>body</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
<span class=w>    </span><span class=k>height</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>day</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>background</span><span class=p>:</span><span class=w> </span><span class=mh>#fff</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=mh>#222</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>night</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>background</span><span class=p>:</span><span class=w> </span><span class=mh>#222</span><span class=p>;</span>
<span class=w>    </span><span class=k>color</span><span class=p>:</span><span class=w> </span><span class=mh>#fff</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>In this example, the side effect (modifying the DOM) was not necessary at all. You only needed to return JSX.</p> <p></solution></p> <h4 id=fix-a-broken-profile>Fix a broken profile<a class=headerlink href=#fix-a-broken-profile title="Permanent link">&para;</a></h4> <p>Two <code>Profile</code> components are rendered side by side with different data. Press "Collapse" on the first profile, and then "Expand" it. You'll notice that both profiles now show the same person. This is a bug.</p> <p>Find the cause of the bug and fix it.</p> <p><hint></p> <p>The buggy code is in <code>Profile.js</code>. Make sure you read it all from top to bottom!</p> <p></hint></p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Panel</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./Panel.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>getImageUrl</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./utils.js&quot;</span><span class=p>;</span>

<span class=kd>let</span><span class=w> </span><span class=nx>currentPerson</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Profile</span><span class=p>({</span><span class=w> </span><span class=nx>person</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>currentPerson</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>person</span><span class=p>;</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>Panel</span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Header</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Avatar</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/Panel&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Header</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>currentPerson</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Avatar</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>img</span>
<span class=w>            </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;avatar&quot;</span>
<span class=w>            </span><span class=nx>src</span><span class=o>=</span><span class=p>{</span><span class=nx>getImageUrl</span><span class=p>(</span><span class=nx>currentPerson</span><span class=p>)}</span>
<span class=w>            </span><span class=nx>alt</span><span class=o>=</span><span class=p>{</span><span class=nx>currentPerson</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span>
<span class=w>            </span><span class=nx>width</span><span class=o>=</span><span class=p>{</span><span class=mf>50</span><span class=p>}</span>
<span class=w>            </span><span class=nx>height</span><span class=o>=</span><span class=p>{</span><span class=mf>50</span><span class=p>}</span>
<span class=w>        </span><span class=o>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Panel</span><span class=p>({</span><span class=w> </span><span class=nx>children</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>open</span><span class=p>,</span><span class=w> </span><span class=nx>setOpen</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>section</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;panel&quot;</span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setOpen</span><span class=p>(</span><span class=o>!</span><span class=nx>open</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>open</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Collapse&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Expand&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>open</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nx>children</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/section&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Profile</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./Profile.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Profile</span>
<span class=w>                </span><span class=nx>person</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                    </span><span class=nx>imageId</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;lrWQx8l&quot;</span><span class=p>,</span>
<span class=w>                    </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Subrahmanyan Chandrasekhar&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=p>}}</span>
<span class=w>            </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Profile</span>
<span class=w>                </span><span class=nx>person</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                    </span><span class=nx>imageId</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;MK3eW3A&quot;</span><span class=p>,</span>
<span class=w>                    </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Creola Katherine Johnson&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=p>}}</span>
<span class=w>            </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>getImageUrl</span><span class=p>(</span><span class=nx>person</span><span class=p>,</span><span class=w> </span><span class=nx>size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;s&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s2>&quot;https://i.imgur.com/&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>person</span><span class=p>.</span><span class=nx>imageId</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>size</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;.jpg&quot;</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>.</span><span class=nc>avatar</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>%</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>panel</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>border</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=kt>px</span><span class=w> </span><span class=kc>solid</span><span class=w> </span><span class=mh>#aaa</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-top</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>200</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>h1</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>18</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>The problem is that the <code>Profile</code> component writes to a preexisting variable called <code>currentPerson</code>, and the <code>Header</code> and <code>Avatar</code> components read from it. This makes <em>all three of them</em> impure and difficult to predict.</p> <p>To fix the bug, remove the <code>currentPerson</code> variable. Instead, pass all information from <code>Profile</code> to <code>Header</code> and <code>Avatar</code> via props. You'll need to add a <code>person</code> prop to both components and pass it all the way down.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Panel</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./Panel.js&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>getImageUrl</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./utils.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Profile</span><span class=p>({</span><span class=w> </span><span class=nx>person</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>Panel</span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Header</span><span class=w> </span><span class=nx>person</span><span class=o>=</span><span class=p>{</span><span class=nx>person</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Avatar</span><span class=w> </span><span class=nx>person</span><span class=o>=</span><span class=p>{</span><span class=nx>person</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/Panel&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Header</span><span class=p>({</span><span class=w> </span><span class=nx>person</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&lt;</span><span class=nx>h1</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>person</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/h1&gt;;</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>Avatar</span><span class=p>({</span><span class=w> </span><span class=nx>person</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>img</span>
<span class=w>            </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;avatar&quot;</span>
<span class=w>            </span><span class=nx>src</span><span class=o>=</span><span class=p>{</span><span class=nx>getImageUrl</span><span class=p>(</span><span class=nx>person</span><span class=p>)}</span>
<span class=w>            </span><span class=nx>alt</span><span class=o>=</span><span class=p>{</span><span class=nx>person</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span>
<span class=w>            </span><span class=nx>width</span><span class=o>=</span><span class=p>{</span><span class=mf>50</span><span class=p>}</span>
<span class=w>            </span><span class=nx>height</span><span class=o>=</span><span class=p>{</span><span class=mf>50</span><span class=p>}</span>
<span class=w>        </span><span class=o>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>Panel</span><span class=p>({</span><span class=w> </span><span class=nx>children</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>open</span><span class=p>,</span><span class=w> </span><span class=nx>setOpen</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>section</span><span class=w> </span><span class=nx>className</span><span class=o>=</span><span class=s2>&quot;panel&quot;</span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>button</span><span class=w> </span><span class=nx>on_click</span><span class=o>=</span><span class=p>{()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>setOpen</span><span class=p>(</span><span class=o>!</span><span class=nx>open</span><span class=p>)}</span><span class=o>&gt;</span>
<span class=w>                </span><span class=p>{</span><span class=nx>open</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=s2>&quot;Collapse&quot;</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Expand&quot;</span><span class=p>}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=err>/button&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>open</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nx>children</span><span class=p>}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/section&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nx>Profile</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./Profile.js&quot;</span><span class=p>;</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Profile</span>
<span class=w>                </span><span class=nx>person</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                    </span><span class=nx>imageId</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;lrWQx8l&quot;</span><span class=p>,</span>
<span class=w>                    </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Subrahmanyan Chandrasekhar&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=p>}}</span>
<span class=w>            </span><span class=o>/&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>Profile</span>
<span class=w>                </span><span class=nx>person</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                    </span><span class=nx>imageId</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;MK3eW3A&quot;</span><span class=p>,</span>
<span class=w>                    </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Creola Katherine Johnson&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=p>}}</span>
<span class=w>            </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>getImageUrl</span><span class=p>(</span><span class=nx>person</span><span class=p>,</span><span class=w> </span><span class=nx>size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&quot;s&quot;</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=s2>&quot;https://i.imgur.com/&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>person</span><span class=p>.</span><span class=nx>imageId</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>size</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s2>&quot;.jpg&quot;</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>.</span><span class=nc>avatar</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=kt>%</span><span class=p>;</span>
<span class=p>}</span>
<span class=p>.</span><span class=nc>panel</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>border</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=kt>px</span><span class=w> </span><span class=kc>solid</span><span class=w> </span><span class=mh>#aaa</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-top</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>200</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
<span class=nt>h1</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>font-size</span><span class=p>:</span><span class=w> </span><span class=mi>18</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Remember that React does not guarantee that component functions will execute in any particular order, so you can't communicate between them by setting variables. All communication must happen through props.</p> <p></solution></p> <h4 id=fix-a-broken-story-tray>Fix a broken story tray<a class=headerlink href=#fix-a-broken-story-tray title="Permanent link">&para;</a></h4> <p>The CEO of your company is asking you to add "stories" to your online clock app, and you can't say no. You've written a <code>StoryTray</code> component that accepts a list of <code>stories</code>, followed by a "Create Story" placeholder.</p> <p>You implemented the "Create Story" placeholder by pushing one more fake story at the end of the <code>stories</code> array that you receive as a prop. But for some reason, "Create Story" appears more than once. Fix the issue.</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>StoryTray</span><span class=p>({</span><span class=w> </span><span class=nx>stories</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>stories</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
<span class=w>        </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Create Story&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=p>});</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>stories</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>story</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>(</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>li</span><span class=w> </span><span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>story</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>story</span><span class=p>.</span><span class=nx>label</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>            </span><span class=p>))}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/ul&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>StoryTray</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./StoryTray.js&quot;</span><span class=p>;</span>

<span class=kd>let</span><span class=w> </span><span class=nx>initialStories</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=p>,</span><span class=w> </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Ankit&#39;s Story&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=mf>1</span><span class=p>,</span><span class=w> </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Taylor&#39;s Story&quot;</span><span class=w> </span><span class=p>},</span>
<span class=p>];</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>[</span><span class=nx>stories</span><span class=p>,</span><span class=w> </span><span class=nx>setStories</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>([...</span><span class=nx>initialStories</span><span class=p>]);</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useTime</span><span class=p>();</span>

<span class=w>    </span><span class=c1>// HACK: Prevent the memory from growing forever while you read docs.</span>
<span class=w>    </span><span class=c1>// We&#39;re breaking our own rules here.</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>stories</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>100</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>stories</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>100</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>div</span>
<span class=w>            </span><span class=nx>style</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                </span><span class=nx>width</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;100%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>height</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;100%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>textAlign</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;center&quot;</span><span class=p>,</span>
<span class=w>            </span><span class=p>}}</span>
<span class=w>        </span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>It</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>toLocaleTimeString</span><span class=p>()}</span><span class=w> </span><span class=nx>now</span><span class=p>.</span><span class=o>&lt;</span><span class=err>/h2&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>StoryTray</span><span class=w> </span><span class=nx>stories</span><span class=o>=</span><span class=p>{</span><span class=nx>stories</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/div&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useTime</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>time</span><span class=p>,</span><span class=w> </span><span class=nx>setTime</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setTime</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>time</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>ul</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>list-style-type</span><span class=p>:</span><span class=w> </span><span class=kc>none</span><span class=p>;</span>
<span class=p>}</span>

<span class=nt>li</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>border</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=kt>px</span><span class=w> </span><span class=kc>solid</span><span class=w> </span><span class=mh>#aaa</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>float</span><span class=p>:</span><span class=w> </span><span class=kc>left</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>70</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>height</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span class=p>{</span>
<span class=w>  </span><span class=s2>&quot;hardReloadOnChange&quot;</span><span class=o>:</span><span class=w> </span><span class=kc>true</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p><solution></p> <p>Notice how whenever the clock updates, "Create Story" is added <em>twice</em>. This serves as a hint that we have a mutation during rendering--Strict Mode calls components twice to make these issues more noticeable.</p> <p><code>StoryTray</code> function is not pure. By calling <code>push</code> on the received <code>stories</code> array (a prop!), it is mutating an object that was created <em>before</em> <code>StoryTray</code> started rendering. This makes it buggy and very difficult to predict.</p> <p>The simplest fix is to not touch the array at all, and render "Create Story" separately:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>StoryTray</span><span class=p>({</span><span class=w> </span><span class=nx>stories</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>stories</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>story</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>(</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>li</span><span class=w> </span><span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>story</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>story</span><span class=p>.</span><span class=nx>label</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>            </span><span class=p>))}</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>li</span><span class=o>&gt;</span><span class=nx>Create</span><span class=w> </span><span class=nx>Story</span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/ul&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>StoryTray</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./StoryTray.js&quot;</span><span class=p>;</span>

<span class=kd>let</span><span class=w> </span><span class=nx>initialStories</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=p>,</span><span class=w> </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Ankit&#39;s Story&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=mf>1</span><span class=p>,</span><span class=w> </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Taylor&#39;s Story&quot;</span><span class=w> </span><span class=p>},</span>
<span class=p>];</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>[</span><span class=nx>stories</span><span class=p>,</span><span class=w> </span><span class=nx>setStories</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>([...</span><span class=nx>initialStories</span><span class=p>]);</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useTime</span><span class=p>();</span>

<span class=w>    </span><span class=c1>// HACK: Prevent the memory from growing forever while you read docs.</span>
<span class=w>    </span><span class=c1>// We&#39;re breaking our own rules here.</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>stories</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>100</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>stories</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>100</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>div</span>
<span class=w>            </span><span class=nx>style</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                </span><span class=nx>width</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;100%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>height</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;100%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>textAlign</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;center&quot;</span><span class=p>,</span>
<span class=w>            </span><span class=p>}}</span>
<span class=w>        </span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>It</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>toLocaleTimeString</span><span class=p>()}</span><span class=w> </span><span class=nx>now</span><span class=p>.</span><span class=o>&lt;</span><span class=err>/h2&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>StoryTray</span><span class=w> </span><span class=nx>stories</span><span class=o>=</span><span class=p>{</span><span class=nx>stories</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/div&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useTime</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>time</span><span class=p>,</span><span class=w> </span><span class=nx>setTime</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setTime</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>time</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>ul</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>list-style-type</span><span class=p>:</span><span class=w> </span><span class=kc>none</span><span class=p>;</span>
<span class=p>}</span>

<span class=nt>li</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>border</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=kt>px</span><span class=w> </span><span class=kc>solid</span><span class=w> </span><span class=mh>#aaa</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>float</span><span class=p>:</span><span class=w> </span><span class=kc>left</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>70</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>height</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>Alternatively, you could create a <em>new</em> array (by copying the existing one) before you push an item into it:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>StoryTray</span><span class=p>({</span><span class=w> </span><span class=nx>stories</span><span class=w> </span><span class=p>})</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Copy the array!</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>storiesToDisplay</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>stories</span><span class=p>.</span><span class=nx>slice</span><span class=p>();</span>

<span class=w>    </span><span class=c1>// Does not affect the original array:</span>
<span class=w>    </span><span class=nx>storiesToDisplay</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
<span class=w>        </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;create&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Create Story&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=p>});</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>ul</span><span class=o>&gt;</span>
<span class=w>            </span><span class=p>{</span><span class=nx>storiesToDisplay</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>story</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>(</span>
<span class=w>                </span><span class=o>&lt;</span><span class=nx>li</span><span class=w> </span><span class=nx>key</span><span class=o>=</span><span class=p>{</span><span class=nx>story</span><span class=p>.</span><span class=nx>id</span><span class=p>}</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>story</span><span class=p>.</span><span class=nx>label</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/li&gt;</span>
<span class=w>            </span><span class=p>))}</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/ul&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nx>useState</span><span class=p>,</span><span class=w> </span><span class=nx>useEffect</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;react&quot;</span><span class=p>;</span>
<span class=k>import</span><span class=w> </span><span class=nx>StoryTray</span><span class=w> </span><span class=kr>from</span><span class=w> </span><span class=s2>&quot;./StoryTray.js&quot;</span><span class=p>;</span>

<span class=kd>let</span><span class=w> </span><span class=nx>initialStories</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span>
<span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=mf>0</span><span class=p>,</span><span class=w> </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Ankit&#39;s Story&quot;</span><span class=w> </span><span class=p>},</span>
<span class=w>    </span><span class=p>{</span><span class=w> </span><span class=nx>id</span><span class=o>:</span><span class=w> </span><span class=mf>1</span><span class=p>,</span><span class=w> </span><span class=nx>label</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;Taylor&#39;s Story&quot;</span><span class=w> </span><span class=p>},</span>
<span class=p>];</span>

<span class=k>export</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>[</span><span class=nx>stories</span><span class=p>,</span><span class=w> </span><span class=nx>setStories</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>([...</span><span class=nx>initialStories</span><span class=p>]);</span>
<span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=nx>time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useTime</span><span class=p>();</span>

<span class=w>    </span><span class=c1>// HACK: Prevent the memory from growing forever while you read docs.</span>
<span class=w>    </span><span class=c1>// We&#39;re breaking our own rules here.</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>stories</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>100</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>stories</span><span class=p>.</span><span class=nx>length</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>100</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>(</span>
<span class=w>        </span><span class=o>&lt;</span><span class=nx>div</span>
<span class=w>            </span><span class=nx>style</span><span class=o>=</span><span class=p>{{</span>
<span class=w>                </span><span class=nx>width</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;100%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>height</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;100%&quot;</span><span class=p>,</span>
<span class=w>                </span><span class=nx>textAlign</span><span class=o>:</span><span class=w> </span><span class=s2>&quot;center&quot;</span><span class=p>,</span>
<span class=w>            </span><span class=p>}}</span>
<span class=w>        </span><span class=o>&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>h2</span><span class=o>&gt;</span><span class=nx>It</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=p>{</span><span class=nx>time</span><span class=p>.</span><span class=nx>toLocaleTimeString</span><span class=p>()}</span><span class=w> </span><span class=nx>now</span><span class=p>.</span><span class=o>&lt;</span><span class=err>/h2&gt;</span>
<span class=w>            </span><span class=o>&lt;</span><span class=nx>StoryTray</span><span class=w> </span><span class=nx>stories</span><span class=o>=</span><span class=p>{</span><span class=nx>stories</span><span class=p>}</span><span class=w> </span><span class=o>/&gt;</span>
<span class=w>        </span><span class=o>&lt;</span><span class=err>/div&gt;</span>
<span class=w>    </span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>function</span><span class=w> </span><span class=nx>useTime</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=p>[</span><span class=nx>time</span><span class=p>,</span><span class=w> </span><span class=nx>setTime</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>useState</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>    </span><span class=nx>useEffect</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>setInterval</span><span class=p>(()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>setTime</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=nb>Date</span><span class=p>());</span>
<span class=w>        </span><span class=p>},</span><span class=w> </span><span class=mf>1000</span><span class=p>);</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=nx>clearInterval</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=p>[]);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>time</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nt>ul</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>list-style-type</span><span class=p>:</span><span class=w> </span><span class=kc>none</span><span class=p>;</span>
<span class=p>}</span>

<span class=nt>li</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>border</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=kt>px</span><span class=w> </span><span class=kc>solid</span><span class=w> </span><span class=mh>#aaa</span><span class=p>;</span>
<span class=w>    </span><span class=k>border-radius</span><span class=p>:</span><span class=w> </span><span class=mi>6</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>float</span><span class=p>:</span><span class=w> </span><span class=kc>left</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>margin-bottom</span><span class=p>:</span><span class=w> </span><span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>padding</span><span class=p>:</span><span class=w> </span><span class=mi>5</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>70</span><span class=kt>px</span><span class=p>;</span>
<span class=w>    </span><span class=k>height</span><span class=p>:</span><span class=w> </span><span class=mi>100</span><span class=kt>px</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div> <p>This keeps your mutation local and your rendering function pure. However, you still need to be careful: for example, if you tried to change any of the array's existing items, you'd have to clone those items too.</p> <p>It is useful to remember which operations on arrays mutate them, and which don't. For example, <code>push</code>, <code>pop</code>, <code>reverse</code>, and <code>sort</code> will mutate the original array, but <code>slice</code>, <code>filter</code>, and <code>map</code> will create a new one.</p> <p></solution></p> <p></challenges></p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 28, 2023 08:11:22 UTC">August 28, 2023</span> </small> </div> <div class=md-source-date> <small> Authors: <span class="git-page-authors git-authors"><a href=mailto:16909269+archmonger@users.noreply.github.com>Archmonger</a></span> </small> </div> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy;<div id=year> </div> <script> document.getElementById("year").innerHTML = new Date().getFullYear(); </script>Reactive Python and affiliates.<div class=legal-footer-right>This project has no affiliation to ReactJS or Meta Platforms, Inc.</div> </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "content.code.copy", "search.highlight"], "search": "../../assets/javascripts/workers/search.a264c092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.4e0fa4ba.min.js></script> <script src=../../assets/js/main.js></script> </body> </html>