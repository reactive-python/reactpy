
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="It's React, but in Python.">
      
      
        <meta name="author" content="Archmonger">
      
      
        <link rel="canonical" href="https://reactive-python.github.io/reactpy/learn/lifecycle-of-reactive-effects/">
      
      
        <link rel="prev" href="../you-might-not-need-an-effect/">
      
      
        <link rel="next" href="../separating-events-from-effects/">
      
      <link rel="icon" href="https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.16">
    
    
      
        <title>Lifecycle of Reactive Effects ðŸš§ - ReactPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../static/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ReactPy" class="md-header__button md-logo" aria-label="ReactPy" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ReactPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lifecycle of Reactive Effects ðŸš§
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81 1.42-1.42M1 13h3v-2H1m12 9h-2v3h2"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/reactive-python/reactpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    reactive-python/reactpy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../get-started/" class="md-tabs__link">
        Get Started
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../your-first-component/" class="md-tabs__link md-tabs__link--active">
        Learn React
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/use-state/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/changelog/" class="md-tabs__link">
        About ReactPy
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ReactPy" class="md-nav__button md-logo" aria-label="ReactPy" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/reactive-python/reactpy/main/branding/svg/reactpy-logo-square.svg" alt="logo">

    </a>
    ReactPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/reactive-python/reactpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    reactive-python/reactpy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Get Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Quick Start
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Quick Start
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../get-started/" class="md-nav__link">
        Get Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-tic-tac-toe/" class="md-nav__link">
        Tutorial: Tic-Tac-Toe ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../thinking-in-react/" class="md-nav__link">
        Thinking in React
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../start-a-new-react-project/" class="md-nav__link">
        Start a New React Project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../add-react-to-an-existing-project/" class="md-nav__link">
        Add React to an Existing Project ðŸš«
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../editor-setup/" class="md-nav__link">
        Editor Setup ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../react-developer-tools/" class="md-nav__link">
        React Developer Tools ðŸš«
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          More Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          More Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-react-bootstrap/" class="md-nav__link">
        Tutorial: React Bootstrap ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-material-ui/" class="md-nav__link">
        Tutorial: Material UI ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Learn React
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Learn React
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Describing the UI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Describing the UI
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../your-first-component/" class="md-nav__link">
        Your First Component ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../importing-and-exporting-components/" class="md-nav__link">
        Importing and Exporting Components ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../writing-markup-with-psx/" class="md-nav__link">
        Writing Markup with PSX ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-in-psx-with-curly-braces/" class="md-nav__link">
        Python in PSX with Curly Braces ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../passing-props-to-a-component/" class="md-nav__link">
        Passing Props to a Component ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../conditional-rendering/" class="md-nav__link">
        Conditional Rendering ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rendering-lists/" class="md-nav__link">
        Rendering Lists ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../keeping-components-pure/" class="md-nav__link">
        Keeping Components Pure ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Adding Interactivity
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Adding Interactivity
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../responding-to-events/" class="md-nav__link">
        Responding to Events ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../state-a-components-memory/" class="md-nav__link">
        State: A Component's Memory ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../render-and-commit/" class="md-nav__link">
        Render and Commit ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../state-as-a-snapshot/" class="md-nav__link">
        State as a Snapshot ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../queueing-a-series-of-state-updates/" class="md-nav__link">
        Queueing a Series of State Updates ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updating-objects-in-state/" class="md-nav__link">
        Updating Objects in State ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updating-arrays-in-state/" class="md-nav__link">
        Updating Arrays in State ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Managing State
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Managing State
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reacting-to-input-with-state/" class="md-nav__link">
        Reacting to Input with State ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../choosing-the-state-structure/" class="md-nav__link">
        Choosing the State Structure ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sharing-state-between-components/" class="md-nav__link">
        Sharing State Between Components ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preserving-and-resetting-state/" class="md-nav__link">
        Preserving and Resetting State ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../extracting-state-logic-into-a-reducer/" class="md-nav__link">
        Extracting State Logic into a Reducer ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../passing-data-deeply-with-context/" class="md-nav__link">
        Passing Data Deeply with Context ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scaling-up-with-reducer-and-context/" class="md-nav__link">
        Scaling Up with Reducer and Context ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Escape Hatches
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Escape Hatches
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../referencing-values-with-refs/" class="md-nav__link">
        Referencing Values with Refs ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manipulating-the-dom-with-refs/" class="md-nav__link">
        Manipulating the DOM with Refs ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../synchronizing-with-effects/" class="md-nav__link">
        Synchronizing with Effects ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../you-might-not-need-an-effect/" class="md-nav__link">
        You Might Not Need an Effect ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Lifecycle of Reactive Effects ðŸš§
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Lifecycle of Reactive Effects ðŸš§
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-lifecycle-of-an-effect" class="md-nav__link">
    The lifecycle of an Effect
  </a>
  
    <nav class="md-nav" aria-label="The lifecycle of an Effect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-synchronization-may-need-to-happen-more-than-once" class="md-nav__link">
    Why synchronization may need to happen more than once
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-react-re-synchronizes-your-effect" class="md-nav__link">
    How React re-synchronizes your Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thinking-from-the-effects-perspective" class="md-nav__link">
    Thinking from the Effect's perspective
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-react-verifies-that-your-effect-can-re-synchronize" class="md-nav__link">
    How React verifies that your Effect can re-synchronize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-react-knows-that-it-needs-to-re-synchronize-the-effect" class="md-nav__link">
    How React knows that it needs to re-synchronize the Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#each-effect-represents-a-separate-synchronization-process" class="md-nav__link">
    Each Effect represents a separate synchronization process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#effects-react-to-reactive-values" class="md-nav__link">
    Effects "react" to reactive values
  </a>
  
    <nav class="md-nav" aria-label="Effects "react" to reactive values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-an-effect-with-empty-dependencies-means" class="md-nav__link">
    What an Effect with empty dependencies means
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-variables-declared-in-the-component-body-are-reactive" class="md-nav__link">
    All variables declared in the component body are reactive
  </a>
  
    <nav class="md-nav" aria-label="All variables declared in the component body are reactive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-global-or-mutable-values-be-dependencies" class="md-nav__link">
    Can global or mutable values be dependencies?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#react-verifies-that-you-specified-every-reactive-value-as-a-dependency" class="md-nav__link">
    React verifies that you specified every reactive value as a dependency
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-to-do-when-you-dont-want-to-re-synchronize" class="md-nav__link">
    What to do when you don't want to re-synchronize
  </a>
  
    <nav class="md-nav" aria-label="What to do when you don't want to re-synchronize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fix-reconnecting-on-every-keystroke" class="md-nav__link">
    Fix reconnecting on every keystroke
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-synchronization-on-and-off" class="md-nav__link">
    Switch synchronization on and off
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#investigate-a-stale-value-bug" class="md-nav__link">
    Investigate a stale value bug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-a-connection-switch" class="md-nav__link">
    Fix a connection switch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populate-a-chain-of-select-boxes" class="md-nav__link">
    Populate a chain of select boxes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../separating-events-from-effects/" class="md-nav__link">
        Separating Events from Effects ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../removing-effect-dependencies/" class="md-nav__link">
        Removing Effect Dependencies ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reusing-logic-with-custom-hooks/" class="md-nav__link">
        Reusing Logic with Custom Hooks ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../communicate-data-between-server-and-client/" class="md-nav__link">
        Communicating Data Between Server and Client ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../convert-between-vdom-and-html/" class="md-nav__link">
        Convert Between VDOM and HTML ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vdom-mutations/" class="md-nav__link">
        VDOM Mutations ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../creating-vdom-event-handlers/" class="md-nav__link">
        Creating VDOM Event Handlers ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../creating-html-tags/" class="md-nav__link">
        Creating HTML Tags ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../creating-backends/" class="md-nav__link">
        Creating Backends ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manually-register-a-client/" class="md-nav__link">
        Manually Register a Client ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Hooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Hooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-state/" class="md-nav__link">
        Use State ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-effect/" class="md-nav__link">
        Use Effect ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-context/" class="md-nav__link">
        Use Context ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-reducer/" class="md-nav__link">
        Use Reducer ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-callback/" class="md-nav__link">
        Use Callback ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-memo/" class="md-nav__link">
        Use Memo ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-ref/" class="md-nav__link">
        Use Ref ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-debug-value/" class="md-nav__link">
        Use Debug Value ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-connection/" class="md-nav__link">
        Use Connection ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-scope/" class="md-nav__link">
        Use Scope ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/use-location/" class="md-nav__link">
        Use Location ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          HTML Tags
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          HTML Tags
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/common-types/" class="md-nav__link">
        Common Types ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/common-props/" class="md-nav__link">
        Common Props ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/common-events/" class="md-nav__link">
        Common Events ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/usage/" class="md-nav__link">
        Usage ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
      
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          Backends
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Backends
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/fastapi/" class="md-nav__link">
        FastAPI ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/flask/" class="md-nav__link">
        Flask ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/sanic/" class="md-nav__link">
        Sanic ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/starlette/" class="md-nav__link">
        Starlette ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tornado/" class="md-nav__link">
        Tornado ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/django/" class="md-nav__link">
        Django ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/jupyter/" class="md-nav__link">
        Jupyter ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/plotly-dash/" class="md-nav__link">
        Plotly Dash ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/protocol-structure/" class="md-nav__link">
        Protocol Structure ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/client-api/" class="md-nav__link">
        Client API ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          About ReactPy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          About ReactPy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/community/" class="md-nav__link">
        Community ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/running-tests/" class="md-nav__link">
        Running Tests ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/code/" class="md-nav__link">
        Contributing Code ðŸš§
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/docs/" class="md-nav__link">
        Contributing Documentation ðŸš§
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-lifecycle-of-an-effect" class="md-nav__link">
    The lifecycle of an Effect
  </a>
  
    <nav class="md-nav" aria-label="The lifecycle of an Effect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-synchronization-may-need-to-happen-more-than-once" class="md-nav__link">
    Why synchronization may need to happen more than once
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-react-re-synchronizes-your-effect" class="md-nav__link">
    How React re-synchronizes your Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thinking-from-the-effects-perspective" class="md-nav__link">
    Thinking from the Effect's perspective
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-react-verifies-that-your-effect-can-re-synchronize" class="md-nav__link">
    How React verifies that your Effect can re-synchronize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-react-knows-that-it-needs-to-re-synchronize-the-effect" class="md-nav__link">
    How React knows that it needs to re-synchronize the Effect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#each-effect-represents-a-separate-synchronization-process" class="md-nav__link">
    Each Effect represents a separate synchronization process
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#effects-react-to-reactive-values" class="md-nav__link">
    Effects "react" to reactive values
  </a>
  
    <nav class="md-nav" aria-label="Effects "react" to reactive values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-an-effect-with-empty-dependencies-means" class="md-nav__link">
    What an Effect with empty dependencies means
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-variables-declared-in-the-component-body-are-reactive" class="md-nav__link">
    All variables declared in the component body are reactive
  </a>
  
    <nav class="md-nav" aria-label="All variables declared in the component body are reactive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-global-or-mutable-values-be-dependencies" class="md-nav__link">
    Can global or mutable values be dependencies?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#react-verifies-that-you-specified-every-reactive-value-as-a-dependency" class="md-nav__link">
    React verifies that you specified every reactive value as a dependency
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-to-do-when-you-dont-want-to-re-synchronize" class="md-nav__link">
    What to do when you don't want to re-synchronize
  </a>
  
    <nav class="md-nav" aria-label="What to do when you don't want to re-synchronize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fix-reconnecting-on-every-keystroke" class="md-nav__link">
    Fix reconnecting on every keystroke
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-synchronization-on-and-off" class="md-nav__link">
    Switch synchronization on and off
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#investigate-a-stale-value-bug" class="md-nav__link">
    Investigate a stale value bug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fix-a-connection-switch" class="md-nav__link">
    Fix a connection switch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#populate-a-chain-of-select-boxes" class="md-nav__link">
    Populate a chain of select boxes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


  <h1>Lifecycle of Reactive Effects ðŸš§</h1>

<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p class="intro">

Effects have a different lifecycle from components. Components may mount, update, or unmount. An Effect can only do two things: to start synchronizing something, and later to stop synchronizing it. This cycle can happen multiple times if your Effect depends on props and state that change over time. React provides a linter rule to check that you've specified your Effect's dependencies correctly. This keeps your Effect synchronized to the latest props and state.

</p>
<div class="admonition summary">
<p class="admonition-title">You Will Learn</p>
<ul>
<li>How an Effect's lifecycle is different from a component's lifecycle</li>
<li>How to think about each individual Effect in isolation</li>
<li>When your Effect needs to re-synchronize, and why</li>
<li>How your Effect's dependencies are determined</li>
<li>What it means for a value to be reactive</li>
<li>What an empty dependency array means</li>
<li>How React verifies your dependencies are correct with a linter</li>
<li>What to do when you disagree with the linter</li>
</ul>
</div>
<h2 id="the-lifecycle-of-an-effect">The lifecycle of an Effect<a class="headerlink" href="#the-lifecycle-of-an-effect" title="Permanent link">&para;</a></h2>
<p>Every React component goes through the same lifecycle:</p>
<ul>
<li>A component <em>mounts</em> when it's added to the screen.</li>
<li>A component <em>updates</em> when it receives new props or state, usually in response to an interaction.</li>
<li>A component <em>unmounts</em> when it's removed from the screen.</li>
</ul>
<p><strong>It's a good way to think about components, but <em>not</em> about Effects.</strong> Instead, try to think about each Effect independently from your component's lifecycle. An Effect describes how to <a href="/learn/synchronizing-with-effects">synchronize an external system</a> to the current props and state. As your code changes, synchronization will need to happen more or less often.</p>
<p>To illustrate this point, consider this Effect connecting your component to a chat server:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Your Effect's body specifies how to <strong>start synchronizing:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// ...</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="p">};</span>
<span class="c1">// ...</span>
</code></pre></div></td></tr></table></div>
<p>The cleanup function returned by your Effect specifies how to <strong>stop synchronizing:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// ...</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="p">};</span>
<span class="c1">// ...</span>
</code></pre></div></td></tr></table></div>
<p>Intuitively, you might think that React would <strong>start synchronizing</strong> when your component mounts and <strong>stop synchronizing</strong> when your component unmounts. However, this is not the end of the story! Sometimes, it may also be necessary to <strong>start and stop synchronizing multiple times</strong> while the component remains mounted.</p>
<p>Let's look at <em>why</em> this is necessary, <em>when</em> it happens, and <em>how</em> you can control this behavior.</p>
<p><Note></p>
<p>Some Effects don't return a cleanup function at all. <a href="/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development">More often than not,</a> you'll want to return one--but if you don't, React will behave as if you returned an empty cleanup function.</p>
<p></Note></p>
<h3 id="why-synchronization-may-need-to-happen-more-than-once">Why synchronization may need to happen more than once<a class="headerlink" href="#why-synchronization-may-need-to-happen-more-than-once" title="Permanent link">&para;</a></h3>
<p>Imagine this <code>ChatRoom</code> component receives a <code>roomId</code> prop that the user picks in a dropdown. Let's say that initially the user picks the <code>"general"</code> room as the <code>roomId</code>. Your app displays the <code>"general"</code> chat room:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="cm">/* &quot;general&quot; */</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>After the UI is displayed, React will run your Effect to <strong>start synchronizing.</strong> It connects to the <code>"general"</code> room:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="cm">/* &quot;general&quot; */</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Connects to the &quot;general&quot; room</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span><span class="w"> </span><span class="c1">// Disconnects from the &quot;general&quot; room</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
<span class="w">  </span><span class="c1">// ...</span>
</code></pre></div></td></tr></table></div>
<p>So far, so good.</p>
<p>Later, the user picks a different room in the dropdown (for example, <code>"travel"</code>). First, React will update the UI:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="cm">/* &quot;travel&quot; */</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Think about what should happen next. The user sees that <code>"travel"</code> is the selected chat room in the UI. However, the Effect that ran the last time is still connected to the <code>"general"</code> room. <strong>The <code>roomId</code> prop has changed, so what your Effect did back then (connecting to the <code>"general"</code> room) no longer matches the UI.</strong></p>
<p>At this point, you want React to do two things:</p>
<ol>
<li>Stop synchronizing with the old <code>roomId</code> (disconnect from the <code>"general"</code> room)</li>
<li>Start synchronizing with the new <code>roomId</code> (connect to the <code>"travel"</code> room)</li>
</ol>
<p><strong>Luckily, you've already taught React how to do both of these things!</strong> Your Effect's body specifies how to start synchronizing, and your cleanup function specifies how to stop synchronizing. All that React needs to do now is to call them in the correct order and with the correct props and state. Let's see how exactly that happens.</p>
<h3 id="how-react-re-synchronizes-your-effect">How React re-synchronizes your Effect<a class="headerlink" href="#how-react-re-synchronizes-your-effect" title="Permanent link">&para;</a></h3>
<p>Recall that your <code>ChatRoom</code> component has received a new value for its <code>roomId</code> prop. It used to be <code>"general"</code>, and now it is <code>"travel"</code>. React needs to re-synchronize your Effect to re-connect you to a different room.</p>
<p>To <strong>stop synchronizing,</strong> React will call the cleanup function that your Effect returned after connecting to the <code>"general"</code> room. Since <code>roomId</code> was <code>"general"</code>, the cleanup function disconnects from the <code>"general"</code> room:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="cm">/* &quot;general&quot; */</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Connects to the &quot;general&quot; room</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span><span class="w"> </span><span class="c1">// Disconnects from the &quot;general&quot; room</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="c1">// ...</span>
</code></pre></div></td></tr></table></div>
<p>Then React will run the Effect that you've provided during this render. This time, <code>roomId</code> is <code>"travel"</code> so it will <strong>start synchronizing</strong> to the <code>"travel"</code> chat room (until its cleanup function is eventually called too):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="cm">/* &quot;travel&quot; */</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Connects to the &quot;travel&quot; room</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// ...</span>
</code></pre></div></td></tr></table></div>
<p>Thanks to this, you're now connected to the same room that the user chose in the UI. Disaster averted!</p>
<p>Every time after your component re-renders with a different <code>roomId</code>, your Effect will re-synchronize. For example, let's say the user changes <code>roomId</code> from <code>"travel"</code> to <code>"music"</code>. React will again <strong>stop synchronizing</strong> your Effect by calling its cleanup function (disconnecting you from the <code>"travel"</code> room). Then it will <strong>start synchronizing</strong> again by running its body with the new <code>roomId</code> prop (connecting you to the <code>"music"</code> room).</p>
<p>Finally, when the user goes to a different screen, <code>ChatRoom</code> unmounts. Now there is no need to stay connected at all. React will <strong>stop synchronizing</strong> your Effect one last time and disconnect you from the <code>"music"</code> chat room.</p>
<h3 id="thinking-from-the-effects-perspective">Thinking from the Effect's perspective<a class="headerlink" href="#thinking-from-the-effects-perspective" title="Permanent link">&para;</a></h3>
<p>Let's recap everything that's happened from the <code>ChatRoom</code> component's perspective:</p>
<ol>
<li><code>ChatRoom</code> mounted with <code>roomId</code> set to <code>"general"</code></li>
<li><code>ChatRoom</code> updated with <code>roomId</code> set to <code>"travel"</code></li>
<li><code>ChatRoom</code> updated with <code>roomId</code> set to <code>"music"</code></li>
<li><code>ChatRoom</code> unmounted</li>
</ol>
<p>During each of these points in the component's lifecycle, your Effect did different things:</p>
<ol>
<li>Your Effect connected to the <code>"general"</code> room</li>
<li>Your Effect disconnected from the <code>"general"</code> room and connected to the <code>"travel"</code> room</li>
<li>Your Effect disconnected from the <code>"travel"</code> room and connected to the <code>"music"</code> room</li>
<li>Your Effect disconnected from the <code>"music"</code> room</li>
</ol>
<p>Now let's think about what happened from the perspective of the Effect itself:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Your Effect connected to the room specified with roomId...</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// ...until it disconnected</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
</code></pre></div></td></tr></table></div>
<p>This code's structure might inspire you to see what happened as a sequence of non-overlapping time periods:</p>
<ol>
<li>Your Effect connected to the <code>"general"</code> room (until it disconnected)</li>
<li>Your Effect connected to the <code>"travel"</code> room (until it disconnected)</li>
<li>Your Effect connected to the <code>"music"</code> room (until it disconnected)</li>
</ol>
<p>Previously, you were thinking from the component's perspective. When you looked from the component's perspective, it was tempting to think of Effects as "callbacks" or "lifecycle events" that fire at a specific time like "after a render" or "before unmount". This way of thinking gets complicated very fast, so it's best to avoid.</p>
<p><strong>Instead, always focus on a single start/stop cycle at a time. It shouldn't matter whether a component is mounting, updating, or unmounting. All you need to do is to describe how to start synchronization and how to stop it. If you do it well, your Effect will be resilient to being started and stopped as many times as it's needed.</strong></p>
<p>This might remind you how you don't think whether a component is mounting or updating when you write the rendering logic that creates JSX. You describe what should be on the screen, and React <a href="/learn/reacting-to-input-with-state">figures out the rest.</a></p>
<h3 id="how-react-verifies-that-your-effect-can-re-synchronize">How React verifies that your Effect can re-synchronize<a class="headerlink" href="#how-react-verifies-that-your-effect-can-re-synchronize" title="Permanent link">&para;</a></h3>
<p>Here is a live example that you can play with. Press "Open chat" to mount the <code>ChatRoom</code> component:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">show</span><span class="p">,</span><span class="w"> </span><span class="nx">setShow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">on_click</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShow</span><span class="p">(</span><span class="o">!</span><span class="nx">show</span><span class="p">)}</span><span class="o">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;Close chat&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Open chat&quot;</span><span class="p">}</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">}</span>
<span class="w">            </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">}</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Notice that when the component mounts for the first time, you see three logs:</p>
<ol>
<li><code>âœ… Connecting to "general" room at https://localhost:1234...</code> <em>(development-only)</em></li>
<li><code>âŒ Disconnected from "general" room at https://localhost:1234.</code> <em>(development-only)</em></li>
<li><code>âœ… Connecting to "general" room at https://localhost:1234...</code></li>
</ol>
<p>The first two logs are development-only. In development, React always remounts each component once.</p>
<p><strong>React verifies that your Effect can re-synchronize by forcing it to do that immediately in development.</strong> This might remind you of opening a door and closing it an extra time to check if the door lock works. React starts and stops your Effect one extra time in development to check <a href="/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development">you've implemented its cleanup well.</a></p>
<p>The main reason your Effect will re-synchronize in practice is if some data it uses has changed. In the sandbox above, change the selected chat room. Notice how, when the <code>roomId</code> changes, your Effect re-synchronizes.</p>
<p>However, there are also more unusual cases in which re-synchronization is necessary. For example, try editing the <code>serverUrl</code> in the sandbox above while the chat is open. Notice how the Effect re-synchronizes in response to your edits to the code. In the future, React may add more features that rely on re-synchronization.</p>
<h3 id="how-react-knows-that-it-needs-to-re-synchronize-the-effect">How React knows that it needs to re-synchronize the Effect<a class="headerlink" href="#how-react-knows-that-it-needs-to-re-synchronize-the-effect" title="Permanent link">&para;</a></h3>
<p>You might be wondering how React knew that your Effect needed to re-synchronize after <code>roomId</code> changes. It's because <em>you told React</em> that its code depends on <code>roomId</code> by including it in the <a href="/learn/synchronizing-with-effects#step-2-specify-the-effect-dependencies">list of dependencies:</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// The roomId prop may change over time</span>
<span class="w">  </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span><span class="w"> </span><span class="c1">// This Effect reads roomId</span>
<span class="w">    </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span><span class="w"> </span><span class="c1">// So you tell React that this Effect &quot;depends on&quot; roomId</span>
<span class="w">  </span><span class="c1">// ...</span>
</code></pre></div></td></tr></table></div>
<p>Here's how this works:</p>
<ol>
<li>You knew <code>roomId</code> is a prop, which means it can change over time.</li>
<li>You knew that your Effect reads <code>roomId</code> (so its logic depends on a value that may change later).</li>
<li>This is why you specified it as your Effect's dependency (so that it re-synchronizes when <code>roomId</code> changes).</li>
</ol>
<p>Every time after your component re-renders, React will look at the array of dependencies that you have passed. If any of the values in the array is different from the value at the same spot that you passed during the previous render, React will re-synchronize your Effect.</p>
<p>For example, if you passed <code>["general"]</code> during the initial render, and later you passed <code>["travel"]</code> during the next render, React will compare <code>"general"</code> and <code>"travel"</code>. These are different values (compared with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is"><code>Object.is</code></a>), so React will re-synchronize your Effect. On the other hand, if your component re-renders but <code>roomId</code> has not changed, your Effect will remain connected to the same room.</p>
<h3 id="each-effect-represents-a-separate-synchronization-process">Each Effect represents a separate synchronization process<a class="headerlink" href="#each-effect-represents-a-separate-synchronization-process" title="Permanent link">&para;</a></h3>
<p>Resist adding unrelated logic to your Effect only because this logic needs to run at the same time as an Effect you already wrote. For example, let's say you want to send an analytics event when the user visits the room. You already have an Effect that depends on <code>roomId</code>, so you might feel tempted to add the analytics call there:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logVisit</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>But imagine you later add another dependency to this Effect that needs to re-establish the connection. If this Effect re-synchronizes, it will also call <code>logVisit(roomId)</code> for the same room, which you did not intend. Logging the visit <strong>is a separate process</strong> from connecting. Write them as two separate Effects:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">logVisit</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// ...</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Each Effect in your code should represent a separate and independent synchronization process.</strong></p>
<p>In the above example, deleting one Effect wouldnâ€™t break the other Effect's logic. This is a good indication that they synchronize different things, and so it made sense to split them up. On the other hand, if you split up a cohesive piece of logic into separate Effects, the code may look "cleaner" but will be <a href="/learn/you-might-not-need-an-effect#chains-of-computations">more difficult to maintain.</a> This is why you should think whether the processes are same or separate, not whether the code looks cleaner.</p>
<h2 id="effects-react-to-reactive-values">Effects "react" to reactive values<a class="headerlink" href="#effects-react-to-reactive-values" title="Permanent link">&para;</a></h2>
<p>Your Effect reads two variables (<code>serverUrl</code> and <code>roomId</code>), but you only specified <code>roomId</code> as a dependency:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Why doesn't <code>serverUrl</code> need to be a dependency?</p>
<p>This is because the <code>serverUrl</code> never changes due to a re-render. It's always the same no matter how many times the component re-renders and why. Since <code>serverUrl</code> never changes, it wouldn't make sense to specify it as a dependency. After all, dependencies only do something when they change over time!</p>
<p>On the other hand, <code>roomId</code> may be different on a re-render. <strong>Props, state, and other values declared inside the component are <em>reactive</em> because they're calculated during rendering and participate in the React data flow.</strong></p>
<p>If <code>serverUrl</code> was a state variable, it would be reactive. Reactive values must be included in dependencies:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Props change over time</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">setServerUrl</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// State may change over time</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Your Effect reads props and state</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">serverUrl</span><span class="p">]);</span><span class="w"> </span><span class="c1">// So you tell React that this Effect &quot;depends on&quot; on props and state</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>By including <code>serverUrl</code> as a dependency, you ensure that the Effect re-synchronizes after it changes.</p>
<p>Try changing the selected chat room or edit the server URL in this sandbox:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">setServerUrl</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">serverUrl</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Server</span><span class="w"> </span><span class="nx">URL</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">serverUrl</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setServerUrl</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Whenever you change a reactive value like <code>roomId</code> or <code>serverUrl</code>, the Effect re-connects to the chat server.</p>
<h3 id="what-an-effect-with-empty-dependencies-means">What an Effect with empty dependencies means<a class="headerlink" href="#what-an-effect-with-empty-dependencies-means" title="Permanent link">&para;</a></h3>
<p>What happens if you move both <code>serverUrl</code> and <code>roomId</code> outside the component?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;general&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// âœ… All dependencies declared</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now your Effect's code does not use <em>any</em> reactive values, so its dependencies can be empty (<code>[]</code>).</p>
<p>Thinking from the component's perspective, the empty <code>[]</code> dependency array means this Effect connects to the chat room only when the component mounts, and disconnects only when the component unmounts. (Keep in mind that React would still <a href="#how-react-verifies-that-your-effect-can-re-synchronize">re-synchronize it an extra time</a> in development to stress-test your logic.)</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;general&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">show</span><span class="p">,</span><span class="w"> </span><span class="nx">setShow</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">button</span><span class="w"> </span><span class="nx">on_click</span><span class="o">=</span><span class="p">{()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setShow</span><span class="p">(</span><span class="o">!</span><span class="nx">show</span><span class="p">)}</span><span class="o">&gt;</span>
<span class="w">                </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">&quot;Close chat&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Open chat&quot;</span><span class="p">}</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">}</span>
<span class="w">            </span><span class="p">{</span><span class="nx">show</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="o">/&gt;</span><span class="p">}</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>However, if you <a href="#thinking-from-the-effects-perspective">think from the Effect's perspective,</a> you don't need to think about mounting and unmounting at all. What's important is you've specified what your Effect does to start and stop synchronizing. Today, it has no reactive dependencies. But if you ever want the user to change <code>roomId</code> or <code>serverUrl</code> over time (and they would become reactive), your Effect's code won't change. You will only need to add them to the dependencies.</p>
<h3 id="all-variables-declared-in-the-component-body-are-reactive">All variables declared in the component body are reactive<a class="headerlink" href="#all-variables-declared-in-the-component-body-are-reactive" title="Permanent link">&para;</a></h3>
<p>Props and state aren't the only reactive values. Values that you calculate from them are also reactive. If the props or state change, your component will re-render, and the values calculated from them will also change. This is why all variables from the component body used by the Effect should be in the Effect dependency list.</p>
<p>Let's say that the user can pick a chat server in the dropdown, but they can also configure a default server in settings. Suppose you've already put the settings state in a <a href="/learn/scaling-up-with-reducer-and-context">context</a> so you read the <code>settings</code> from that context. Now you calculate the <code>serverUrl</code> based on the selected server from props and the default server:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">selectedServerUrl</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// roomId is reactive</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">settings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useContext</span><span class="p">(</span><span class="nx">SettingsContext</span><span class="p">);</span><span class="w"> </span><span class="c1">// settings is reactive</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">selectedServerUrl</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="nx">settings</span><span class="p">.</span><span class="nx">defaultServerUrl</span><span class="p">;</span><span class="w"> </span><span class="c1">// serverUrl is reactive</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Your Effect reads roomId and serverUrl</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">serverUrl</span><span class="p">]);</span><span class="w"> </span><span class="c1">// So it needs to re-synchronize when either of them changes!</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In this example, <code>serverUrl</code> is not a prop or a state variable. It's a regular variable that you calculate during rendering. But it's calculated during rendering, so it can change due to a re-render. This is why it's reactive.</p>
<p><strong>All values inside the component (including props, state, and variables in your component's body) are reactive. Any reactive value can change on a re-render, so you need to include reactive values as Effect's dependencies.</strong></p>
<p>In other words, Effects "react" to all values from the component body.</p>
<p><DeepDive></p>
<h4 id="can-global-or-mutable-values-be-dependencies">Can global or mutable values be dependencies?<a class="headerlink" href="#can-global-or-mutable-values-be-dependencies" title="Permanent link">&para;</a></h4>
<p>Mutable values (including global variables) aren't reactive.</p>
<p><strong>A mutable value like <a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/pathname"><code>location.pathname</code></a> can't be a dependency.</strong> It's mutable, so it can change at any time completely outside of the React rendering data flow. Changing it wouldn't trigger a re-render of your component. Therefore, even if you specified it in the dependencies, React <em>wouldn't know</em> to re-synchronize the Effect when it changes. This also breaks the rules of React because reading mutable data during rendering (which is when you calculate the dependencies) breaks <a href="/learn/keeping-components-pure">purity of rendering.</a> Instead, you should read and subscribe to an external mutable value with <a href="/learn/you-might-not-need-an-effect#subscribing-to-an-external-store"><code>useSyncExternalStore</code>.</a></p>
<p><strong>A mutable value like <a href="/reference/react/useRef#reference"><code>ref.current</code></a> or things you read from it also can't be a dependency.</strong> The ref object returned by <code>useRef</code> itself can be a dependency, but its <code>current</code> property is intentionally mutable. It lets you <a href="/learn/referencing-values-with-refs">keep track of something without triggering a re-render.</a> But since changing it doesn't trigger a re-render, it's not a reactive value, and React won't know to re-run your Effect when it changes.</p>
<p>As you'll learn below on this page, a linter will check for these issues automatically.</p>
<p></DeepDive></p>
<h3 id="react-verifies-that-you-specified-every-reactive-value-as-a-dependency">React verifies that you specified every reactive value as a dependency<a class="headerlink" href="#react-verifies-that-you-specified-every-reactive-value-as-a-dependency" title="Permanent link">&para;</a></h3>
<p>If your linter is <a href="/learn/editor-setup#linting">configured for React,</a> it will check that every reactive value used by your Effect's code is declared as its dependency. For example, this is a lint error because both <code>roomId</code> and <code>serverUrl</code> are reactive:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// roomId is reactive</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">setServerUrl</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// serverUrl is reactive</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// &lt;-- Something&#39;s wrong here!</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Server</span><span class="w"> </span><span class="nx">URL</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">serverUrl</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setServerUrl</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This may look like a React error, but really React is pointing out a bug in your code. Both <code>roomId</code> and <code>serverUrl</code> may change over time, but you're forgetting to re-synchronize your Effect when they change. You will remain connected to the initial <code>roomId</code> and <code>serverUrl</code> even after the user picks different values in the UI.</p>
<p>To fix the bug, follow the linter's suggestion to specify <code>roomId</code> and <code>serverUrl</code> as dependencies of your Effect:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// roomId is reactive</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">setServerUrl</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// serverUrl is reactive</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">]);</span><span class="w"> </span><span class="c1">// âœ… All dependencies declared</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Try this fix in the sandbox above. Verify that the linter error is gone, and the chat re-connects when needed.</p>
<p><Note></p>
<p>In some cases, React <em>knows</em> that a value never changes even though it's declared inside the component. For example, the <a href="/reference/react/useState#setstate"><code>set</code> function</a> returned from <code>useState</code> and the ref object returned by <a href="/reference/react/useRef"><code>useRef</code></a> are <em>stable</em>--they are guaranteed to not change on a re-render. Stable values aren't reactive, so you may omit them from the list. Including them is allowed: they won't change, so it doesn't matter.</p>
<p></Note></p>
<h3 id="what-to-do-when-you-dont-want-to-re-synchronize">What to do when you don't want to re-synchronize<a class="headerlink" href="#what-to-do-when-you-dont-want-to-re-synchronize" title="Permanent link">&para;</a></h3>
<p>In the previous example, you've fixed the lint error by listing <code>roomId</code> and <code>serverUrl</code> as dependencies.</p>
<p><strong>However, you could instead "prove" to the linter that these values aren't reactive values,</strong> i.e. that they <em>can't</em> change as a result of a re-render. For example, if <code>serverUrl</code> and <code>roomId</code> don't depend on rendering and always have the same values, you can move them outside the component. Now they don't need to be dependencies:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// serverUrl is not reactive</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;general&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// roomId is not reactive</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// âœ… All dependencies declared</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>You can also move them <em>inside the Effect.</em> They aren't calculated during rendering, so they're not reactive:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// serverUrl is not reactive</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;general&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// roomId is not reactive</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span><span class="w"> </span><span class="c1">// âœ… All dependencies declared</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><strong>Effects are reactive blocks of code.</strong> They re-synchronize when the values you read inside of them change. Unlike event handlers, which only run once per interaction, Effects run whenever synchronization is necessary.</p>
<p><strong>You can't "choose" your dependencies.</strong> Your dependencies must include every <a href="#all-variables-declared-in-the-component-body-are-reactive">reactive value</a> you read in the Effect. The linter enforces this. Sometimes this may lead to problems like infinite loops and to your Effect re-synchronizing too often. Don't fix these problems by suppressing the linter! Here's what to try instead:</p>
<ul>
<li>
<p><strong>Check that your Effect represents an independent synchronization process.</strong> If your Effect doesn't synchronize anything, <a href="/learn/you-might-not-need-an-effect">it might be unnecessary.</a> If it synchronizes several independent things, <a href="#each-effect-represents-a-separate-synchronization-process">split it up.</a></p>
</li>
<li>
<p><strong>If you want to read the latest value of props or state without "reacting" to it and re-synchronizing the Effect,</strong> you can split your Effect into a reactive part (which you'll keep in the Effect) and a non-reactive part (which you'll extract into something called an <em>Effect Event</em>). <a href="/learn/separating-events-from-effects">Read about separating Events from Effects.</a></p>
</li>
<li>
<p><strong>Avoid relying on objects and functions as dependencies.</strong> If you create objects and functions during rendering and then read them from an Effect, they will be different on every render. This will cause your Effect to re-synchronize every time. <a href="/learn/removing-effect-dependencies">Read more about removing unnecessary dependencies from Effects.</a></p>
</li>
</ul>
<p><Pitfall></p>
<p>The linter is your friend, but its powers are limited. The linter only knows when the dependencies are <em>wrong</em>. It doesn't know <em>the best</em> way to solve each case. If the linter suggests a dependency, but adding it causes a loop, it doesn't mean the linter should be ignored. You need to change the code inside (or outside) the Effect so that that value isn't reactive and doesn't <em>need</em> to be a dependency.</p>
<p>If you have an existing codebase, you might have some Effects that suppress the linter like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="c1">// ðŸ”´ Avoid suppressing the linter like this:</span>
<span class="w">    </span><span class="c1">// eslint-ignore-next-line react-hooks/exhaustive-deps</span>
<span class="p">},</span><span class="w"> </span><span class="p">[]);</span>
</code></pre></div></td></tr></table></div>
<p>On the <a href="/learn/separating-events-from-effects">next</a> <a href="/learn/removing-effect-dependencies">pages</a>, you'll learn how to fix this code without breaking the rules. It's always worth fixing!</p>
<p></Pitfall></p>
<p><Recap></p>
<ul>
<li>Components can mount, update, and unmount.</li>
<li>Each Effect has a separate lifecycle from the surrounding component.</li>
<li>Each Effect describes a separate synchronization process that can <em>start</em> and <em>stop</em>.</li>
<li>When you write and read Effects, think from each individual Effect's perspective (how to start and stop synchronization) rather than from the component's perspective (how it mounts, updates, or unmounts).</li>
<li>Values declared inside the component body are "reactive".</li>
<li>Reactive values should re-synchronize the Effect because they can change over time.</li>
<li>The linter verifies that all reactive values used inside the Effect are specified as dependencies.</li>
<li>All errors flagged by the linter are legitimate. There's always a way to fix the code to not break the rules.</li>
</ul>
<p></Recap></p>
<p><Challenges></p>
<h4 id="fix-reconnecting-on-every-keystroke">Fix reconnecting on every keystroke<a class="headerlink" href="#fix-reconnecting-on-every-keystroke" title="Permanent link">&para;</a></h4>
<p>In this example, the <code>ChatRoom</code> component connects to the chat room when the component mounts, disconnects when it unmounts, and reconnects when you select a different chat room. This behavior is correct, so you need to keep it working.</p>
<p>However, there is a problem. Whenever you type into the message box input at the bottom, <code>ChatRoom</code> <em>also</em> reconnects to the chat. (You can notice this by clearing the console and typing into the input.) Fix the issue so that this doesn't happen.</p>
<p><Hint></p>
<p>You might need to add a dependency array for this Effect. What dependencies should be there?</p>
<p></Hint></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">message</span><span class="p">,</span><span class="w"> </span><span class="nx">setMessage</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">message</span><span class="p">}</span>
<span class="w">                </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setMessage</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><Solution></p>
<p>This Effect didn't have a dependency array at all, so it re-synchronized after every re-render. First, add a dependency array. Then, make sure that every reactive value used by the Effect is specified in the array. For example, <code>roomId</code> is reactive (because it's a prop), so it should be included in the array. This ensures that when the user selects a different room, the chat reconnects. On the other hand, <code>serverUrl</code> is defined outside the component. This is why it doesn't need to be in the array.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://localhost:1234&quot;</span><span class="p">;</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">message</span><span class="p">,</span><span class="w"> </span><span class="nx">setMessage</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">message</span><span class="p">}</span>
<span class="w">                </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setMessage</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">serverUrl</span><span class="p">,</span><span class="w"> </span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room at &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">serverUrl</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p></Solution></p>
<h4 id="switch-synchronization-on-and-off">Switch synchronization on and off<a class="headerlink" href="#switch-synchronization-on-and-off" title="Permanent link">&para;</a></h4>
<p>In this example, an Effect subscribes to the window <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/pointermove_event"><code>pointermove</code></a> event to move a pink dot on the screen. Try hovering over the preview area (or touching the screen if you're on a mobile device), and see how the pink dot follows your movement.</p>
<p>There is also a checkbox. Ticking the checkbox toggles the <code>canMove</code> state variable, but this state variable is not used anywhere in the code. Your task is to change the code so that when <code>canMove</code> is <code>false</code> (the checkbox is ticked off), the dot should stop moving. After you toggle the checkbox back on (and set <code>canMove</code> to <code>true</code>), the box should follow the movement again. In other words, whether the dot can move or not should stay synchronized to whether the checkbox is checked.</p>
<p><Hint></p>
<p>You can't declare an Effect conditionally. However, the code inside the Effect can use conditions!</p>
<p></Hint></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">,</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">canMove</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="nx">dot</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">allowed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">move</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span>
<span class="w">                </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
<span class="w">                    </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">borderRadius</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;50%&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">transform</span><span class="o">:</span><span class="w"> </span><span class="sb">`translate(</span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">px, </span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">px)`</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">pointerEvents</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                </span><span class="p">}}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><Solution></p>
<p>One solution is to wrap the <code>setPosition</code> call into an <code>if (canMove) { ... }</code> condition:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">,</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">canMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="w"> </span><span class="p">});</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">canMove</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="nx">dot</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">allowed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">move</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span>
<span class="w">                </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
<span class="w">                    </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">borderRadius</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;50%&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">transform</span><span class="o">:</span><span class="w"> </span><span class="sb">`translate(</span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">px, </span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">px)`</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">pointerEvents</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                </span><span class="p">}}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Alternatively, you could wrap the <em>event subscription</em> logic into an <code>if (canMove) { ... }</code> condition:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">,</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">canMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">canMove</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="nx">dot</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">allowed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">move</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span>
<span class="w">                </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
<span class="w">                    </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">borderRadius</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;50%&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">transform</span><span class="o">:</span><span class="w"> </span><span class="sb">`translate(</span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">px, </span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">px)`</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">pointerEvents</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                </span><span class="p">}}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In both of these cases, <code>canMove</code> is a reactive variable that you read inside the Effect. This is why it must be specified in the list of Effect dependencies. This ensures that the Effect re-synchronizes after every change to its value.</p>
<p></Solution></p>
<h4 id="investigate-a-stale-value-bug">Investigate a stale value bug<a class="headerlink" href="#investigate-a-stale-value-bug" title="Permanent link">&para;</a></h4>
<p>In this example, the pink dot should move when the checkbox is on, and should stop moving when the checkbox is off. The logic for this has already been implemented: the <code>handleMove</code> event handler checks the <code>canMove</code> state variable.</p>
<p>However, for some reason, the <code>canMove</code> state variable inside <code>handleMove</code> appears to be "stale": it's always <code>true</code>, even after you tick off the checkbox. How is this possible? Find the mistake in the code and fix it.</p>
<p><Hint></p>
<p>If you see a linter rule being suppressed, remove the suppression! That's where the mistakes usually are.</p>
<p></Hint></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">,</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">canMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// eslint-disable-next-line react-hooks/exhaustive-deps</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">canMove</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="nx">dot</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">allowed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">move</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span>
<span class="w">                </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
<span class="w">                    </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">borderRadius</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;50%&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">transform</span><span class="o">:</span><span class="w"> </span><span class="sb">`translate(</span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">px, </span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">px)`</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">pointerEvents</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                </span><span class="p">}}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><Solution></p>
<p>The problem with the original code was suppressing the dependency linter. If you remove the suppression, you'll see that this Effect depends on the <code>handleMove</code> function. This makes sense: <code>handleMove</code> is declared inside the component body, which makes it a reactive value. Every reactive value must be specified as a dependency, or it can potentially get stale over time!</p>
<p>The author of the original code has "lied" to React by saying that the Effect does not depend (<code>[]</code>) on any reactive values. This is why React did not re-synchronize the Effect after <code>canMove</code> has changed (and <code>handleMove</code> with it). Because React did not re-synchronize the Effect, the <code>handleMove</code> attached as a listener is the <code>handleMove</code> function created during the initial render. During the initial render, <code>canMove</code> was <code>true</code>, which is why <code>handleMove</code> from the initial render will forever see that value.</p>
<p><strong>If you never suppress the linter, you will never see problems with stale values.</strong> There are a few different ways to solve this bug, but you should always start by removing the linter suppression. Then change the code to fix the lint error.</p>
<p>You can change the Effect dependencies to <code>[handleMove]</code>, but since it's going to be a newly defined function for every render, you might as well remove dependencies array altogether. Then the Effect <em>will</em> re-synchronize after every re-render:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">,</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">canMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">canMove</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="nx">dot</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">allowed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">move</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span>
<span class="w">                </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
<span class="w">                    </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">borderRadius</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;50%&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">transform</span><span class="o">:</span><span class="w"> </span><span class="sb">`translate(</span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">px, </span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">px)`</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">pointerEvents</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                </span><span class="p">}}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This solution works, but it's not ideal. If you put <code>console.log('Resubscribing')</code> inside the Effect, you'll notice that it resubscribes after every re-render. Resubscribing is fast, but it would still be nice to avoid doing it so often.</p>
<p>A better fix would be to move the <code>handleMove</code> function <em>inside</em> the Effect. Then <code>handleMove</code> won't be a reactive value, and so your Effect won't depend on a function. Instead, it will need to depend on <code>canMove</code> which your code now reads from inside the Effect. This matches the behavior you wanted, since your Effect will now stay synchronized with the value of <code>canMove</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">,</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">function</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">canMove</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">setPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span><span class="w"> </span><span class="p">});</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;pointermove&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">handleMove</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">canMove</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">canMove</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setCanMove</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">The</span><span class="w"> </span><span class="nx">dot</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">allowed</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">move</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">div</span>
<span class="w">                </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
<span class="w">                    </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">backgroundColor</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">borderRadius</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;50%&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">opacity</span><span class="o">:</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">transform</span><span class="o">:</span><span class="w"> </span><span class="sb">`translate(</span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="sb">px, </span><span class="si">${</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="sb">px)`</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">pointerEvents</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">left</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">top</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">20</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">40</span><span class="p">,</span>
<span class="w">                </span><span class="p">}}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Try adding <code>console.log('Resubscribing')</code> inside the Effect body and notice that now it only resubscribes when you toggle the checkbox (<code>canMove</code> changes) or edit the code. This makes it better than the previous approach that always resubscribed.</p>
<p>You'll learn a more general approach to this type of problem in <a href="/learn/separating-events-from-effects">Separating Events from Effects.</a></p>
<p></Solution></p>
<h4 id="fix-a-connection-switch">Fix a connection switch<a class="headerlink" href="#fix-a-connection-switch" title="Permanent link">&para;</a></h4>
<p>In this example, the chat service in <code>chat.js</code> exposes two different APIs: <code>createEncryptedConnection</code> and <code>createUnencryptedConnection</code>. The root <code>App</code> component lets the user choose whether to use encryption or not, and then passes down the corresponding API method to the child <code>ChatRoom</code> component as the <code>createConnection</code> prop.</p>
<p>Notice that initially, the console logs say the connection is not encrypted. Try toggling the checkbox on: nothing will happen. However, if you change the selected room after that, then the chat will reconnect <em>and</em> enable encryption (as you'll see from the console messages). This is a bug. Fix the bug so that toggling the checkbox <em>also</em> causes the chat to reconnect.</p>
<p><Hint></p>
<p>Suppressing the linter is always suspicious. Could this be a bug?</p>
<p></Hint></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./ChatRoom.js&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">createEncryptedConnection</span><span class="p">,</span>
<span class="w">    </span><span class="nx">createUnencryptedConnection</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isEncrypted</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsEncrypted</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">isEncrypted</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setIsEncrypted</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">Enable</span><span class="w"> </span><span class="nx">encryption</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span>
<span class="w">                </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                </span><span class="nx">createConnection</span><span class="o">=</span><span class="p">{</span>
<span class="w">                    </span><span class="nx">isEncrypted</span>
<span class="w">                        </span><span class="o">?</span><span class="w"> </span><span class="nx">createEncryptedConnection</span>
<span class="w">                        </span><span class="o">:</span><span class="w"> </span><span class="nx">createUnencryptedConnection</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// eslint-disable-next-line react-hooks/exhaustive-deps</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createEncryptedConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… ðŸ” Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;... (encrypted)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ ðŸ” Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room (encrypted)&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createUnencryptedConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;... (unencrypted)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room (unencrypted)&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><Solution></p>
<p>If you remove the linter suppression, you will see a lint error. The problem is that <code>createConnection</code> is a prop, so it's a reactive value. It can change over time! (And indeed, it should--when the user ticks the checkbox, the parent component passes a different value of the <code>createConnection</code> prop.) This is why it should be a dependency. Include it in the list to fix the bug:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./ChatRoom.js&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">createEncryptedConnection</span><span class="p">,</span>
<span class="w">    </span><span class="nx">createUnencryptedConnection</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isEncrypted</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsEncrypted</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">isEncrypted</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setIsEncrypted</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">Enable</span><span class="w"> </span><span class="nx">encryption</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span>
<span class="w">                </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                </span><span class="nx">createConnection</span><span class="o">=</span><span class="p">{</span>
<span class="w">                    </span><span class="nx">isEncrypted</span>
<span class="w">                        </span><span class="o">?</span><span class="w"> </span><span class="nx">createEncryptedConnection</span>
<span class="w">                        </span><span class="o">:</span><span class="w"> </span><span class="nx">createUnencryptedConnection</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createEncryptedConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… ðŸ” Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;... (encrypted)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ ðŸ” Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room (encrypted)&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createUnencryptedConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;... (unencrypted)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room (unencrypted)&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>It is correct that <code>createConnection</code> is a dependency. However, this code is a bit fragile because someone could edit the <code>App</code> component to pass an inline function as the value of this prop. In that case, its value would be different every time the <code>App</code> component re-renders, so the Effect might re-synchronize too often. To avoid this, you can pass <code>isEncrypted</code> down instead:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./ChatRoom.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;general&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">isEncrypted</span><span class="p">,</span><span class="w"> </span><span class="nx">setIsEncrypted</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Choose</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">chat</span><span class="w"> </span><span class="nx">room</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setRoomId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;general&quot;</span><span class="o">&gt;</span><span class="nx">general</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;travel&quot;</span><span class="o">&gt;</span><span class="nx">travel</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="s2">&quot;music&quot;</span><span class="o">&gt;</span><span class="nx">music</span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">input</span>
<span class="w">                    </span><span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span>
<span class="w">                    </span><span class="nx">checked</span><span class="o">=</span><span class="p">{</span><span class="nx">isEncrypted</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">setIsEncrypted</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">checked</span><span class="p">)}</span>
<span class="w">                </span><span class="o">/&gt;</span>
<span class="w">                </span><span class="nx">Enable</span><span class="w"> </span><span class="nx">encryption</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">ChatRoom</span><span class="w"> </span><span class="nx">roomId</span><span class="o">=</span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">isEncrypted</span><span class="o">=</span><span class="p">{</span><span class="nx">isEncrypted</span><span class="p">}</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">createEncryptedConnection</span><span class="p">,</span>
<span class="w">    </span><span class="nx">createUnencryptedConnection</span><span class="p">,</span>
<span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./chat.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">ChatRoom</span><span class="p">({</span><span class="w"> </span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">isEncrypted</span><span class="w"> </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">createConnection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">isEncrypted</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="nx">createEncryptedConnection</span>
<span class="w">            </span><span class="o">:</span><span class="w"> </span><span class="nx">createUnencryptedConnection</span><span class="p">;</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">createConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">);</span>
<span class="w">        </span><span class="nx">connection</span><span class="p">.</span><span class="nx">connect</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">connection</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">();</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">roomId</span><span class="p">,</span><span class="w"> </span><span class="nx">isEncrypted</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="p">{</span><span class="nx">roomId</span><span class="p">}</span><span class="w"> </span><span class="nx">room</span><span class="o">!&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createEncryptedConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… ðŸ” Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;... (encrypted)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ ðŸ” Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room (encrypted)&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">createUnencryptedConnection</span><span class="p">(</span><span class="nx">roomId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// A real implementation would actually connect to the server</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">connect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;âœ… Connecting to &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;... (unencrypted)&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">disconnect</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;âŒ Disconnected from &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">roomId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot; room (unencrypted)&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>In this version, the <code>App</code> component passes a boolean prop instead of a function. Inside the Effect, you decide which function to use. Since both <code>createEncryptedConnection</code> and <code>createUnencryptedConnection</code> are declared outside the component, they aren't reactive, and don't need to be dependencies. You'll learn more about this in <a href="/learn/removing-effect-dependencies">Removing Effect Dependencies.</a></p>
<p></Solution></p>
<h4 id="populate-a-chain-of-select-boxes">Populate a chain of select boxes<a class="headerlink" href="#populate-a-chain-of-select-boxes" title="Permanent link">&para;</a></h4>
<p>In this example, there are two select boxes. One select box lets the user pick a planet. Another select box lets the user pick a place <em>on that planet.</em> The second box doesn't work yet. Your task is to make it show the places on the chosen planet.</p>
<p>Look at how the first select box works. It populates the <code>planetList</code> state with the result from the <code>"/planets"</code> API call. The currently selected planet's ID is kept in the <code>planetId</code> state variable. You need to find where to add some additional code so that the <code>placeList</code> state variable is populated with the result of the <code>"/planets/" + planetId + "/places"</code> API call.</p>
<p>If you implement this right, selecting a planet should populate the place list. Changing a planet should change the place list.</p>
<p><Hint></p>
<p>If you have two independent synchronization processes, you need to write two separate Effects.</p>
<p></Hint></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">fetchData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./api.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Page</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">planetList</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlanetList</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">([]);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">planetId</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlanetId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">placeList</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlaceList</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">([]);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">placeId</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlaceId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">fetchData</span><span class="p">(</span><span class="s2">&quot;/planets&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">ignore</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Fetched a list of planets.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setPlanetList</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setPlanetId</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">id</span><span class="p">);</span><span class="w"> </span><span class="c1">// Select the first planet</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Pick</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">planet</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">planetId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">setPlanetId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="p">{</span><span class="nx">planetList</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">planet</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">                            </span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="p">))}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Pick</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">place</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">placeId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">setPlaceId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="p">{</span><span class="nx">placeList</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">place</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">                            </span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="p">))}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">You</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">going</span><span class="w"> </span><span class="nx">to</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">placeId</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;???&quot;</span><span class="p">}</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="p">{</span><span class="nx">planetId</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;???&quot;</span><span class="p">}{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/p&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchData</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;/planets&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchPlanets</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;/planets/&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\/planets\/([\w-]+)\/places(\/)?$/</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Expected URL like &quot;/planets/earth/places&quot;. Received: &quot;&#39;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="nx">url</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="s1">&#39;&quot;.&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchPlaces</span><span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;Expected URL like &quot;/planets&quot; or &quot;/planets/earth/places&quot;. Received: &quot;&#39;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nx">url</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s1">&#39;&quot;.&#39;</span>
<span class="w">        </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchPlanets</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;earth&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;venus&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Venus&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;mars&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Mars&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">]);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchPlaces</span><span class="p">(</span><span class="nx">planetId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">planetId</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">            </span><span class="s2">&quot;fetchPlaces(planetId) expects a string argument. &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s2">&quot;Instead received: &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nx">planetId</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s2">&quot;.&quot;</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;earth&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;laos&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Laos&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;spain&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Spain&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;vietnam&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Vietnam&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;venus&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;aurelia&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Aurelia&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;diana-chasma&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Diana Chasma&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;kumsong-vallis&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;KÅ­msÅng Vallis&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;mars&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;aluminum-city&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Aluminum City&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;new-new-york&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;New New York&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;vishniac&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Vishniac&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Unknown planet ID: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">planetId</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><Solution></p>
<p>There are two independent synchronization processes:</p>
<ul>
<li>The first select box is synchronized to the remote list of planets.</li>
<li>The second select box is synchronized to the remote list of places for the current <code>planetId</code>.</li>
</ul>
<p>This is why it makes sense to describe them as two separate Effects. Here's an example of how you could do this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">fetchData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./api.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Page</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">planetList</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlanetList</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">([]);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">planetId</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlanetId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">placeList</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlaceList</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">([]);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">placeId</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlaceId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">fetchData</span><span class="p">(</span><span class="s2">&quot;/planets&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">ignore</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Fetched a list of planets.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setPlanetList</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setPlanetId</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">id</span><span class="p">);</span><span class="w"> </span><span class="c1">// Select the first planet</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[]);</span>

<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Nothing is selected in the first box yet</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">fetchData</span><span class="p">(</span><span class="s2">&quot;/planets/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">planetId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/places&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">ignore</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Fetched a list of places on &quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">planetId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;.&#39;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setPlaceList</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setPlaceId</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">id</span><span class="p">);</span><span class="w"> </span><span class="c1">// Select the first place</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">planetId</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Pick</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">planet</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">planetId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">setPlanetId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="p">{</span><span class="nx">planetList</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">planet</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">                            </span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="p">))}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Pick</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">place</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">placeId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">setPlaceId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="p">{</span><span class="nx">placeList</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">place</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">                            </span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="p">))}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">You</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">going</span><span class="w"> </span><span class="nx">to</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">placeId</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;???&quot;</span><span class="p">}</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="p">{</span><span class="nx">planetId</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;???&quot;</span><span class="p">}{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/p&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchData</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;/planets&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchPlanets</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;/planets/&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\/planets\/([\w-]+)\/places(\/)?$/</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Expected URL like &quot;/planets/earth/places&quot;. Received: &quot;&#39;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="nx">url</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="s1">&#39;&quot;.&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchPlaces</span><span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;Expected URL like &quot;/planets&quot; or &quot;/planets/earth/places&quot;. Received: &quot;&#39;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nx">url</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s1">&#39;&quot;.&#39;</span>
<span class="w">        </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchPlanets</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;earth&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;venus&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Venus&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;mars&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Mars&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">]);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchPlaces</span><span class="p">(</span><span class="nx">planetId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">planetId</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">            </span><span class="s2">&quot;fetchPlaces(planetId) expects a string argument. &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s2">&quot;Instead received: &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nx">planetId</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s2">&quot;.&quot;</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;earth&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;laos&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Laos&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;spain&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Spain&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;vietnam&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Vietnam&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;venus&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;aurelia&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Aurelia&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;diana-chasma&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Diana Chasma&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;kumsong-vallis&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;KÅ­msÅng Vallis&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;mars&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;aluminum-city&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Aluminum City&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;new-new-york&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;New New York&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;vishniac&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Vishniac&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Unknown planet ID: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">planetId</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This code is a bit repetitive. However, that's not a good reason to combine it into a single Effect! If you did this, you'd have to combine both Effect's dependencies into one list, and then changing the planet would refetch the list of all planets. Effects are not a tool for code reuse.</p>
<p>Instead, to reduce repetition, you can extract some logic into a custom Hook like <code>useSelectOptions</code> below:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useSelectOptions</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./useSelectOptions.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Page</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">planetList</span><span class="p">,</span><span class="w"> </span><span class="nx">planetId</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlanetId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useSelectOptions</span><span class="p">(</span><span class="s2">&quot;/planets&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">placeList</span><span class="p">,</span><span class="w"> </span><span class="nx">placeId</span><span class="p">,</span><span class="w"> </span><span class="nx">setPlaceId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useSelectOptions</span><span class="p">(</span>
<span class="w">        </span><span class="nx">planetId</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="sb">`/planets/</span><span class="si">${</span><span class="nx">planetId</span><span class="si">}</span><span class="sb">/places`</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">&lt;&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Pick</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">planet</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">planetId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">setPlanetId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="p">{</span><span class="nx">planetList</span><span class="o">?</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">planet</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">                            </span><span class="p">{</span><span class="nx">planet</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="p">))}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">label</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">Pick</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">place</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="nx">select</span>
<span class="w">                    </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">placeId</span><span class="p">}</span>
<span class="w">                    </span><span class="nx">onChange</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">setPlaceId</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}}</span>
<span class="w">                </span><span class="o">&gt;</span>
<span class="w">                    </span><span class="p">{</span><span class="nx">placeList</span><span class="o">?</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">place</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="nx">option</span><span class="w"> </span><span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="w"> </span><span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
<span class="w">                            </span><span class="p">{</span><span class="nx">place</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span>
<span class="w">                        </span><span class="o">&lt;</span><span class="err">/option&gt;</span>
<span class="w">                    </span><span class="p">))}</span>
<span class="w">                </span><span class="o">&lt;</span><span class="err">/select&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/label&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">            </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
<span class="w">                </span><span class="nx">You</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">going</span><span class="w"> </span><span class="nx">to</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">placeId</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">}</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="p">{</span><span class="nx">planetId</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">}{</span><span class="s2">&quot; &quot;</span><span class="p">}</span>
<span class="w">            </span><span class="o">&lt;</span><span class="err">/p&gt;</span>
<span class="w">        </span><span class="o">&lt;</span><span class="err">/&gt;</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="p">,</span><span class="w"> </span><span class="nx">useEffect</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">fetchData</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;./api.js&quot;</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">useSelectOptions</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="nx">setList</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">selectedId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedId</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">useEffect</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">fetchData</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">ignore</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">setList</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="w">                </span><span class="nx">setSelectedId</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">id</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="p">[</span><span class="nx">url</span><span class="p">]);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="nx">list</span><span class="p">,</span><span class="w"> </span><span class="nx">selectedId</span><span class="p">,</span><span class="w"> </span><span class="nx">setSelectedId</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchData</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;/planets&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchPlanets</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;/planets/&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^\/planets\/([\w-]+)\/places(\/)?$/</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">match</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">                </span><span class="s1">&#39;Expected URL like &quot;/planets/earth/places&quot;. Received: &quot;&#39;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="nx">url</span><span class="w"> </span><span class="o">+</span>
<span class="w">                    </span><span class="s1">&#39;&quot;.&#39;</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">fetchPlaces</span><span class="p">(</span><span class="nx">match</span><span class="p">[</span><span class="mf">1</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">            </span><span class="s1">&#39;Expected URL like &quot;/planets&quot; or &quot;/planets/earth/places&quot;. Received: &quot;&#39;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nx">url</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s1">&#39;&quot;.&#39;</span>
<span class="w">        </span><span class="p">);</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchPlanets</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;earth&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Earth&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;venus&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Venus&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;mars&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Mars&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">            </span><span class="p">]);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">fetchPlaces</span><span class="p">(</span><span class="nx">planetId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">planetId</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span>
<span class="w">            </span><span class="s2">&quot;fetchPlaces(planetId) expects a string argument. &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s2">&quot;Instead received: &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nx">planetId</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s2">&quot;.&quot;</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;earth&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;laos&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Laos&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;spain&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Spain&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;vietnam&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Vietnam&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;venus&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;aurelia&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Aurelia&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;diana-chasma&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Diana Chasma&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;kumsong-vallis&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;KÅ­msÅng Vallis&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">planetId</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;mars&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">resolve</span><span class="p">([</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;aluminum-city&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Aluminum City&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;new-new-york&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;New New York&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;vishniac&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Vishniac&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                </span><span class="p">]);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Unknown planet ID: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">planetId</span><span class="p">);</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Check the <code>useSelectOptions.js</code> tab in the sandbox to see how it works. Ideally, most Effects in your application should eventually be replaced by custom Hooks, whether written by you or by the community. Custom Hooks hide the synchronization logic, so the calling component doesn't know about the Effect. As you keep working on your app, you'll develop a palette of Hooks to choose from, and eventually you won't need to write Effects in your components very often.</p>
<p></Solution></p>
<p></Challenges></p>





                



              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Reactive Python
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "content.code.copy"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a51614de.min.js"></script>
      
        
          <script src="../../static/js/extra.js"></script>
        
      
    
  </body>
</html>